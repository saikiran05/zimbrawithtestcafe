window["%hammerhead%"].utils.removeInjectedScript(),function gc(vc){var wc=vc.document;!function(c,e,_,E,o){var l="default"in c?c.default:c;e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function t(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t,s,a,l){return new(a=a||e)(function(n,e){function r(t){try{o(l.next(t))}catch(t){e(t)}}function i(t){try{o(l.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((l=l.apply(t,s||[])).next())})}function C(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},l={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function t(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;l&&e[l=0]&&(a=0),a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var n,i,a=Math.floor(399);(i=n=n||{}).ready="ready",i.readyForBrowserManipulation="ready-for-browser-manipulation",i.waitForFileDownload="wait-for-file-download";var u=n,d={dispatchEvent:"dispatch-event",click:"click",rightClick:"right-click",doubleClick:"double-click",drag:"drag",dragToElement:"drag-to-element",hover:"hover",scroll:"scroll",scrollBy:"scroll-by",scrollIntoView:"scroll-into-view",typeText:"type-text",selectText:"select-text",selectTextAreaContent:"select-text-area-content",selectEditableContent:"select-editable-content",pressKey:"press-key",wait:"wait",navigateTo:"navigate-to",setFilesToUpload:"set-files-to-upload",clearUpload:"clear-upload",executeClientFunction:"execute-client-function",executeSelector:"execute-selector",takeScreenshot:"take-screenshot",takeElementScreenshot:"take-element-screenshot",takeScreenshotOnFail:"take-screenshot-on-fail",prepareBrowserManipulation:"prepare-browser-manipulation",showAssertionRetriesStatus:"show-assertion-retries-status",hideAssertionRetriesStatus:"hide-assertion-retries-status",setBreakpoint:"set-breakpoint",resizeWindow:"resize-window",resizeWindowToFitDevice:"resize-window-to-fit-device",maximizeWindow:"maximize-window",switchToIframe:"switch-to-iframe",switchToMainWindow:"switch-to-main-window",openWindow:"open-window",closeWindow:"close-window",getCurrentWindow:"get-current-window",getCurrentWindows:"get-current-windows",switchToWindow:"switch-to-window",switchToWindowByPredicate:"switch-to-window-by-predicate",switchToParentWindow:"switch-to-parent-window",switchToPreviousWindow:"switch-to-previous-window",setNativeDialogHandler:"set-native-dialog-handler",getNativeDialogHistory:"get-native-dialog-history",getBrowserConsoleMessages:"get-browser-console-messages",getActiveElement:"get-active-element",setTestSpeed:"set-test-speed",setPageLoadTimeout:"set-page-load-timeout",debug:"debug",disableDebug:"disable-debug",assertion:"assertion",useRole:"useRole",testDone:"test-done",backupStorages:"backup-storages",executeExpression:"execute-expression",executeAsyncExpression:"execute-async-expression",unlockPage:"unlock-page",closeChildWindowOnFileDownloading:"close-child-window-on-file-downloading",recorder:"recorder",prepareClientEnvironmentInDebugMode:"prepare-client-environment-in-debug-mode",getCookies:"get-cookies",setCookies:"set-cookies",deleteCookies:"delete-cookies",getProxyUrl:"get-proxy-url",request:"request",skipJsErrors:"skip-js-errors",addRequestHooks:"add-request-hooks",removeRequestHooks:"remove-request-hooks",runCustomAction:"run-custom-action"};function h(t){return!(p(r=t)||r.type===d.wait||r.type===d.assertion||r.type===d.executeExpression||m(t)||(n=t).type===d.testDone||n.type===d.showAssertionRetriesStatus||n.type===d.hideAssertionRetriesStatus||n.type===d.setBreakpoint||n.type===d.takeScreenshotOnFail||n.type===d.recorder||n.type===d.getProxyUrl)||f(t)&&!((e=t).type===d.switchToIframe||e.type===d.switchToMainWindow);var e,n,r}function p(t){return t.type===d.executeClientFunction||t.type===d.executeSelector}function f(t){return t.type===d.resizeWindow||t.type===d.resizeWindowToFitDevice||t.type===d.maximizeWindow}function m(t){return(e=t).type===d.takeScreenshot||e.type===d.takeElementScreenshot||e.type===d.takeScreenshotOnFail||f(t);var e}function g(t,e){this.code=t,this.isTestCafeError=!0,this.callsite=e||null}var v,w="step",y="E1",I="E4",S="E5",b="E9",W="E10",T="E11",A="E12",x="E24",R="E26",N="E27",D="E28",P="E29",M="E30",F="E31",k="E32",O="E33",L="E34",U="E35",H="E36",B="E37",G="E39",V="E40",q="E41",z="E42",j="E43",X="E44",Y="E45",K="E46",J="E49",$="E50",Q="E51",Z="E52",tt="E57",et="E64",nt="E65",rt="E68",it="E69",ot="E70",st="E71",at="E72",lt="E73",ut="E74",ct="E76",dt="E77",ht="E78",pt="E82",ft="E83",mt="E90",gt="E91",vt="E92",wt="E93",yt="E94",_t="E95",Et="E97",Ct="E99",It="E100",St="E101",bt=(t(Wt,v=g),Wt);function Wt(t,e,n){var r=v.call(this,t)||this;return r.optionName=e,r.actualValue=n,r}var Tt,At=(t(xt,Tt=g),xt);function xt(t,e){var n=Tt.call(this,J,e)||this;return n.instantiationCallsiteName=t,n}var Rt,Nt=(t(Dt,Rt=g),Dt);function Dt(t,e){var n=Rt.call(this,$,e)||this;return n.instantiationCallsiteName=t,n}var Pt,Mt=(t(Ft,Pt=g),Ft);function Ft(t,e,n){var r=void 0===e?{}:e,i=r.apiFnChain,o=r.apiFnIndex,s=r.reason,a=Pt.call(this,t,n)||this;return a.apiFnChain=i,a.apiFnIndex=o,a.reason=s,a}var kt,Ot=(t(Lt,kt=g),Lt);function Lt(t){return kt.call(this,Q,t)||this}var Ut,Ht=(t(Bt,Ut=Mt),Bt);function Bt(t,e){return Ut.call(this,Z,e,t)||this}var Gt,Vt=(t(qt,Gt=g),qt);function qt(t,e){var n=Gt.call(this,y)||this;return n.errStack=t,n.pageDestUrl=e,n}var zt,jt=(t(Xt,zt=g),Xt);function Xt(t,e,n){var r=zt.call(this,I,n)||this;return r.errMsg=String(e),r.instantiationCallsiteName=t,r}var Yt,Kt=(t(Jt,Yt=g),Jt);function Jt(t,e,n,r){var i=Yt.call(this,S,r)||this;return i.errMsg=String(e),i.property=n,i.instantiationCallsiteName=t,i}var $t,Qt=(t(Zt,$t=g),Zt);function Zt(t){var e=$t.call(this,et)||this;return e.errMsg=String(t),e}var te,ee=(t(ne,te=g),ne);function ne(t,e){var n=te.call(this,nt)||this;return n.errMsg=String(t),n.moduleName=e,n}var re,ie=(t(oe,re=bt),oe);function oe(t,e){return re.call(this,b,t,e)||this}var se,ae=(t(le,se=bt),le);function le(t,e){return se.call(this,W,t,e)||this}var ue,ce=(t(de,ue=bt),de);function de(t,e){return ue.call(this,T,t,e)||this}var he,pe=(t(fe,he=bt),fe);function fe(t,e){return he.call(this,A,t,e)||this}var me,ge=(t(ve,me=bt),ve);function ve(t,e){return me.call(this,mt,t,e)||this}var we,ye=(t(_e,we=bt),_e);function _e(t,e){return we.call(this,Et,t,e)||this}var Ee,Ce=(t(Ie,Ee=bt),Ie);function Ie(t,e){return Ee.call(this,gt,t,e)||this}var Se,be=(t(We,Se=bt),We);function We(t,e){return Se.call(this,vt,t,e)||this}var Te,Ae=(t(xe,Te=bt),xe);function xe(t,e){return Te.call(this,wt,t,e)||this}var Re,Ne=(t(De,Re=bt),De);function De(t,e){return Re.call(this,yt,t,e)||this}var Pe,Me=(t(Fe,Pe=bt),Fe);function Fe(t,e){return Pe.call(this,_t,t,e)||this}var ke,Oe=(t(Le,ke=bt),Le);function Le(t,e){return ke.call(this,Ct,t,e)||this}var Ue,He=(t(Be,Ue=g),Be);function Be(t,e,n){var r=Ue.call(this,It)||this;return r.objectName=t,r.propertyName=e,r.availableProperties=n,r}var Ge,Ve=(t(qe,Ge=Mt),qe);function qe(t,e){return Ge.call(this,x,e,t)||this}var ze,je=(t(Xe,ze=Mt),Xe);function Xe(t,e){return ze.call(this,R,e,t)||this}var Ye,Ke=(t(Je,Ye=g),Je);function Je(t){var e=Ye.call(this,N)||this;return e.nodeDescription=t,e}var $e,Qe=(t(Ze,$e=Mt),Ze);function Ze(t,e){var n=$e.call(this,D,e)||this;return n.argumentName=t,n}var tn,en=(t(nn,tn=g),nn);function nn(t){return tn.call(this,St,t)||this}var rn,on=(t(sn,rn=Mt),sn);function sn(t,e){var n=rn.call(this,P,e)||this;return n.argumentName=t,n}var an,ln=(t(un,an=g),un);function un(t,e){var n=an.call(this,M)||this;return n.argumentName=t,n.nodeDescription=e,n}var cn,dn=(t(hn,cn=g),hn);function hn(){return cn.call(this,F)||this}var pn,fn=(t(mn,pn=g),mn);function mn(){return pn.call(this,k)||this}var gn,vn=(t(wn,gn=g),wn);function wn(t){var e=gn.call(this,O)||this;return e.argumentName=t,e}var yn,_n=(t(En,yn=g),En);function En(){return yn.call(this,U)||this}var Cn,In=(t(Sn,Cn=g),Sn);function Sn(t){var e=Cn.call(this,H)||this;return e.argumentName=t,e}var bn,Wn=(t(Tn,bn=g),Tn);function Tn(t,e){var n=bn.call(this,B)||this;return n.filePaths=t,n.scannedFilePaths=e,n}var An,xn=(t(Rn,An=g),Rn);function Rn(){return An.call(this,L)||this}var Nn,Dn=(t(Pn,Nn=g),Pn);function Pn(t,e){var n=Nn.call(this,q)||this;return n.properties=t?"scrollTargetY property":e?"scrollTargetX property":"scrollTargetX and scrollTargetY properties",n}var Mn,Fn=(t(kn,Mn=g),kn);function kn(t,e){var n=Mn.call(this,tt)||this;return t<=0?e<=0?(n.verb="are",n.dimensions="width and height"):(n.verb="is",n.dimensions="width"):(n.verb="is",n.dimensions="height"),n}var On,Ln=(t(Un,On=g),Un);function Un(t){return On.call(this,V,t)||this}var Hn,Bn=(t(Gn,Hn=g),Gn);function Gn(){return Hn.call(this,G)||this}var Vn,qn=(t(zn,Vn=g),zn);function zn(){return Vn.call(this,z)||this}var jn,Xn=(t(Yn,jn=g),Yn);function Yn(){return jn.call(this,it)||this}var Kn,Jn=(t($n,Kn=g),$n);function $n(){return Kn.call(this,rt)||this}var Qn,Zn=(t(tr,Qn=g),tr);function tr(){return Qn.call(this,ot)||this}var er,nr=(t(rr,er=g),rr);function rr(){return er.call(this,st)||this}var ir,or=(t(sr,ir=g),sr);function sr(){return ir.call(this,lt)||this}var ar,lr=(t(ur,ar=g),ur);function ur(){return ar.call(this,pt)||this}var cr,dr=(t(hr,cr=g),hr);function hr(t){var e=cr.call(this,ht)||this;return e.errMsg=t,e}var pr,fr=(t(mr,pr=g),mr);function mr(){return pr.call(this,ut)||this}var gr,vr=(t(wr,gr=g),wr);function wr(){return gr.call(this,ct)||this}var yr,_r=(t(Er,yr=g),Er);function Er(){return yr.call(this,dt)||this}var Cr,Ir=(t(Sr,Cr=g),Sr);function Sr(){return Cr.call(this,at)||this}var br,Wr=(t(Tr,br=g),Tr);function Tr(){return br.call(this,ft)||this}var Ar,xr=(t(Rr,Ar=g),Rr);function Rr(){return Ar.call(this,j)||this}var Nr,Dr=(t(Pr,Nr=g),Pr);function Pr(){return Nr.call(this,X)||this}var Mr,Fr=(t(kr,Mr=g),kr);function kr(t,e){var n=Mr.call(this,Y)||this;return n.dialogType=t,n.pageUrl=e,n}var Or,Lr=(t(Ur,Or=g),Ur);function Ur(t,e,n){var r=Or.call(this,K)||this;return r.dialogType=t,r.errMsg=e,r.pageUrl=n,r}var Hr=Object.freeze({__proto__:null,TestRunErrorBase:g,ClientFunctionExecutionInterruptionError:At,DomNodeClientFunctionResultError:Nt,SelectorErrorBase:Mt,InvalidSelectorResultError:Ot,CannotObtainInfoForElementSpecifiedBySelectorError:Ht,UncaughtErrorOnPage:Vt,UncaughtErrorInClientFunctionCode:jt,UncaughtErrorInCustomDOMPropertyCode:Kt,UncaughtErrorInCustomClientScriptCode:Qt,UncaughtErrorInCustomClientScriptLoadedFromModule:ee,ActionIntegerOptionError:ie,ActionPositiveIntegerOptionError:ae,ActionBooleanOptionError:ce,ActionSpeedOptionError:pe,ActionStringOptionError:ge,ActionStringOrRegexOptionError:ye,ActionDateOptionError:Ce,ActionNumberOptionError:be,ActionUrlOptionError:Ae,ActionUrlSearchParamsOptionError:Ne,ActionObjectOptionError:Me,ActionFunctionOptionError:Oe,ActionInvalidObjectPropertyError:He,ActionElementNotFoundError:Ve,ActionElementIsInvisibleError:je,ActionSelectorMatchesWrongNodeTypeError:Ke,ActionAdditionalElementNotFoundError:Qe,ActionElementIsNotTargetError:en,ActionAdditionalElementIsInvisibleError:on,ActionAdditionalSelectorMatchesWrongNodeTypeError:ln,ActionElementNonEditableError:dn,ActionElementNotTextAreaError:fn,ActionElementNonContentEditableError:vn,ActionRootContainerNotFoundError:_n,ActionIncorrectKeysError:In,ActionCannotFindFileToUploadError:Wn,ActionElementIsNotFileInputError:xn,ActionInvalidScrollTargetError:Dn,InvalidElementScreenshotDimensionsError:Fn,ActionElementNotIframeError:Ln,ActionIframeIsNotLoadedError:Bn,CurrentIframeIsNotLoadedError:qn,ChildWindowNotFoundError:Xn,ChildWindowIsNotLoadedError:Jn,CannotSwitchToWindowError:Zn,CloseChildWindowError:nr,CannotCloseWindowWithChildrenError:or,CannotCloseWindowWithoutParentError:lr,SwitchToWindowPredicateError:dr,WindowNotFoundError:fr,ParentWindowNotFoundError:vr,PreviousWindowNotFoundError:_r,ChildWindowClosedBeforeSwitchingError:Ir,CannotRestoreChildWindowError:Wr,CurrentIframeNotFoundError:xr,CurrentIframeIsInvisibleError:Dr,NativeDialogNotHandledError:Fr,UncaughtErrorInNativeDialogHandler:Lr}),Br="_nativeMethods",Gr=(Vr.prototype._ensureNativeMethods=function(t){return t||{objectKeys:Object.keys,arrayForEach:Array.prototype.forEach,arrayConcat:Array.prototype.concat,arraySlice:Array.prototype.slice,objectDefineProperty:Object.defineProperty}},Vr.prototype._getWindowIds=function(t){return this[Br].objectKeys(t)},Vr.prototype._copyArray=function(t){return this[Br].arraySlice.call(t)},Vr.prototype._concatArrays=function(t,e){return this[Br].arrayConcat.call(t,e)},Vr.prototype.ensureMessageContainer=function(t){this[t]||(this[t]={log:[],info:[],warn:[],error:[]})},Vr.prototype.concat=function(e){var n=this;if(!e)return this;var t=this._getWindowIds(e);return this[Br].arrayForEach.call(t,function(t){n.ensureMessageContainer(t),n[t].log=n._concatArrays(n[t].log,e[t].log),n[t].info=n._concatArrays(n[t].info,e[t].info),n[t].warn=n._concatArrays(n[t].warn,e[t].warn),n[t].error=n._concatArrays(n[t].error,e[t].error)}),this},Vr.prototype.addMessage=function(t,e,n){this.ensureMessageContainer(n),this[n][t].push(e)},Vr.prototype.getCopy=function(){var e=this,n={},t=this._getWindowIds(this);return this[Br].arrayForEach.call(t,function(t){n[t]={log:e._copyArray(e[t].log),info:e._copyArray(e[t].info),warn:e._copyArray(e[t].warn),error:e._copyArray(e[t].error)}}),n},Vr);function Vr(t,e){var n=this._ensureNativeMethods(e);n.objectDefineProperty(this,Br,{value:n}),this.concat(t)}var qr,zr=(t(jr,qr=Gr),jr);function jr(t){return qr.call(this,t,c.nativeMethods)||this}var Xr,Yr,Kr=(function(t){function n(t){return!!s[t]}function r(t,e){this.references=t,this.transforms=e,this.circularCandidates=[],this.circularCandidatesDescrs=[],this.circularRefCount=0}var o=/^#*@(t|r)$/,i=(0,eval)("this"),s={Int8Array:"function"==typeof Int8Array?Int8Array:void 0,Uint8Array:"function"==typeof Uint8Array?Uint8Array:void 0,Uint8ClampedArray:"function"==typeof Uint8ClampedArray?Uint8ClampedArray:void 0,Int16Array:"function"==typeof Int16Array?Int16Array:void 0,Uint16Array:"function"==typeof Uint16Array?Uint16Array:void 0,Int32Array:"function"==typeof Int32Array?Int32Array:void 0,Uint32Array:"function"==typeof Uint32Array?Uint32Array:void 0,Float32Array:"function"==typeof Float32Array?Float32Array:void 0,Float64Array:"function"==typeof Float64Array?Float64Array:void 0},a="function"==typeof ArrayBuffer,l="function"==typeof Map,u="function"==typeof Set,c="function"==typeof Buffer,d=Array.prototype.slice,e={serialize:function(t){return JSON.stringify(t)},deserialize:function(t){return JSON.parse(t)}};function h(t,e){this.references=t,this.transformMap=e,this.activeTransformsStack=[],this.visitedRefs=Object.create(null)}r._createRefMark=function(t){var e=Object.create(null);return e["@r"]=t,e},r.prototype._createCircularCandidate=function(t,e,n){this.circularCandidates.push(t),this.circularCandidatesDescrs.push({parent:e,key:n,refIdx:-1})},r.prototype._applyTransform=function(t,e,n,r){var i=Object.create(null),o=r.toSerializable(t);return"object"==typeof o&&this._createCircularCandidate(t,e,n),i["@t"]=r.type,i.data=this._handleValue(o,e,n),i},r.prototype._handleArray=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=this._handleValue(t[n],e,n);return e},r.prototype._handlePlainObject=function(n){var r=this,i=Object.create(null);return Object.getOwnPropertyNames(n).forEach(function(t){var e=o.test(t)?"#"+t:t;i[e]=r._handleValue(n[t],i,e)}),i},r.prototype._handleObject=function(t,e,n){return this._createCircularCandidate(t,e,n),Array.isArray(t)?this._handleArray(t):this._handlePlainObject(t)},r.prototype._ensureCircularReference=function(t){var e=this.circularCandidates.indexOf(t);if(-1<e){var n=this.circularCandidatesDescrs[e];return-1===n.refIdx&&(n.refIdx=n.parent?++this.circularRefCount:0),r._createRefMark(n.refIdx)}return null},r.prototype._handleValue=function(t,e,n){var r=typeof t,i="object"==r&&null!==t;if(i){var o=this._ensureCircularReference(t);if(o)return o}for(var s=0;s<this.transforms.length;s++){var a=this.transforms[s];if(a.shouldTransform(r,t))return this._applyTransform(t,e,n,a)}return i?this._handleObject(t,e,n):t},r.prototype.transform=function(){for(var t=[this._handleValue(this.references,null,null)],e=0;e<this.circularCandidatesDescrs.length;e++){var n=this.circularCandidatesDescrs[e];0<n.refIdx&&(t[n.refIdx]=n.parent[n.key],n.parent[n.key]=r._createRefMark(n.refIdx))}return t},h.prototype._handlePlainObject=function(e){var t,n=this,r=Object.create(null),i=Object.getOwnPropertyNames(e);for(t in i.forEach(function(t){n._handleValue(e[t],e,t),o.test(t)&&(r[t.substring(1)]=e[t],delete e[t])}),r)e[t]=r[t]},h.prototype._handleTransformedObject=function(t,e,n){var r=t["@t"],i=this.transformMap[r];if(!i)throw new Error("Can't find transform for \""+r+'" type.');this.activeTransformsStack.push(t),this._handleValue(t.data,t,"data"),this.activeTransformsStack.pop(),e[n]=i.fromSerializable(t.data)},h.prototype._handleCircularSelfRefDuringTransform=function(t,e,n){var r=this.references,i=void 0;Object.defineProperty(e,n,{configurable:!0,enumerable:!0,get:function(){return void 0===i&&(i=r[t]),i},set:function(t){return i=t}})},h.prototype._handleCircularRef=function(t,e,n){-1<this.activeTransformsStack.indexOf(this.references[t])?this._handleCircularSelfRefDuringTransform(t,e,n):(this.visitedRefs[t]||(this.visitedRefs[t]=!0,this._handleValue(this.references[t],this.references,t)),e[n]=this.references[t])},h.prototype._handleValue=function(t,e,n){if("object"==typeof t&&null!==t){var r=t["@r"];if(void 0!==r)this._handleCircularRef(r,e,n);else if(t["@t"])this._handleTransformedObject(t,e,n);else if(Array.isArray(t))for(var i=0;i<t.length;i++)this._handleValue(t[i],t,i);else this._handlePlainObject(t)}},h.prototype.transform=function(){return this.visitedRefs[0]=!0,this._handleValue(this.references[0],this.references,0),this.references[0]};var p=[{type:"[[NaN]]",shouldTransform:function(t,e){return"number"===t&&isNaN(e)},toSerializable:function(){return""},fromSerializable:function(){return NaN}},{type:"[[undefined]]",shouldTransform:function(t){return"undefined"===t},toSerializable:function(){return""},fromSerializable:function(){}},{type:"[[Date]]",shouldTransform:function(t,e){return e instanceof Date},toSerializable:function(t){return t.getTime()},fromSerializable:function(t){var e=new Date;return e.setTime(t),e}},{type:"[[RegExp]]",shouldTransform:function(t,e){return e instanceof RegExp},toSerializable:function(t){var e={src:t.source,flags:""};return t.global&&(e.flags+="g"),t.ignoreCase&&(e.flags+="i"),t.multiline&&(e.flags+="m"),e},fromSerializable:function(t){return new RegExp(t.src,t.flags)}},{type:"[[Error]]",shouldTransform:function(t,e){return e instanceof Error},toSerializable:function(t){return{name:t.name,message:t.message,stack:t.stack}},fromSerializable:function(t){var e=new(i[t.name]||Error)(t.message);return e.stack=t.stack,e}},{type:"[[ArrayBuffer]]",shouldTransform:function(t,e){return a&&e instanceof ArrayBuffer},toSerializable:function(t){var e=new Int8Array(t);return d.call(e)},fromSerializable:function(t){if(a){var e=new ArrayBuffer(t.length);return new Int8Array(e).set(t),e}return t}},{type:"[[Buffer]]",shouldTransform:function(t,e){return c&&e instanceof Buffer},toSerializable:function(t){return d.call(t)},fromSerializable:function(t){return c?Buffer.from(t):t}},{type:"[[TypedArray]]",shouldTransform:function(t,e){return Object.keys(s).some(function(t){return n(t)&&e instanceof s[t]})},toSerializable:function(t){return{ctorName:t.constructor.name,arr:d.call(t)}},fromSerializable:function(t){return n(t.ctorName)?new s[t.ctorName](t.arr):t.arr}},{type:"[[Map]]",shouldTransform:function(t,e){return l&&e instanceof Map},toSerializable:function(t){var n=[];return t.forEach(function(t,e){n.push(e),n.push(t)}),n},fromSerializable:function(t){if(l){for(var e=new Map,n=0;n<t.length;n+=2)e.set(t[n],t[n+1]);return e}for(var r=[],i=0;i<t.length;i+=2)r.push([t[n],t[n+1]]);return r}},{type:"[[Set]]",shouldTransform:function(t,e){return u&&e instanceof Set},toSerializable:function(t){var e=[];return t.forEach(function(t){e.push(t)}),e},fromSerializable:function(t){if(u){for(var e=new Set,n=0;n<t.length;n++)e.add(t[n]);return e}return t}}],f=t.exports=function(t){this.transforms=[],this.transformsMap=Object.create(null),this.serializer=t||e,this.addTransforms(p)};f.prototype.addTransforms=function(t){t=Array.isArray(t)?t:[t];for(var e=0;e<t.length;e++){var n=t[e];if(this.transformsMap[n.type])throw new Error('Transform with type "'+n.type+'" was already added.');this.transforms.push(n),this.transformsMap[n.type]=n}return this},f.prototype.removeTransforms=function(t){t=Array.isArray(t)?t:[t];for(var e=0;e<t.length;e++){var n=t[e],r=this.transforms.indexOf(n);-1<r&&this.transforms.splice(r,1),delete this.transformsMap[n.type]}return this},f.prototype.encode=function(t){var e=new r(t,this.transforms).transform();return this.serializer.serialize(e)},f.prototype.decode=function(t){var e=this.serializer.deserialize(t);return new h(e,this.transformsMap).transform()}}(Xr={exports:{}}),Xr.exports),Jr=function(t){return t};function $r(t){return new Kr({serialize:Jr,deserialize:Jr}).addTransforms(t)}var Qr=1,Zr=2,ti=3,ei=((Yr={})[Qr]=/^\.filterVisible\(\)$/,Yr[Zr]=/^\.filterHidden\(\)$/,Yr[ti]=/^\.nth\(\d+\)$/,Yr);function ni(){this._err=null}var ri=(Object.defineProperty(ni.prototype,"error",{get:function(){return this._err},set:function(t){null===this._err&&(this._err=t)},enumerable:!1,configurable:!0}),ni.prototype.filter=function(t,e,n){if(e.filterVisible&&(t=t.filter(_.positionUtils.isElementVisible),this._assertFilterError(t,n,Qr)),e.filterHidden&&(t=t.filter(function(t){return!_.positionUtils.isElementVisible(t)}),this._assertFilterError(t,n,Zr)),e.counterMode)return null===e.index?t.length:ni._getNodeByIndex(t,e.index)?1:0;var r;if(e.collectionMode)return null!==e.index&&(t=(r=ni._getNodeByIndex(t,e.index))?[r]:[],this._assertFilterError(t,n,ti)),t;var i=ni._getNodeByIndex(t,e.index||0);return i||(this.error=ni._getErrorItem(n,ti)),i},ni.prototype.cast=function(t){if(null==t)return[];if(t instanceof c.nativeMethods.Node)return[t];if(function(t){if(c.nativeMethods.isArray(t)){for(var e=0;e<t.length;e++)if(!(t[e]instanceof c.nativeMethods.Node))return;return 1}}(t))return t;if((e=t)instanceof c.nativeMethods.HTMLCollection||e instanceof c.nativeMethods.NodeList)return function(t){for(var e=t.length,n=[],r=0;r<e;r++)n.push(t[r]);return n}(t);var e;throw new Ot},ni.prototype._assertFilterError=function(t,e,n){0===t.length&&(this.error=ni._getErrorItem(e,n))},ni._getErrorItem=function(t,e){var n=t.apiFnChain,r=t.apiFnID;if(e)for(var i=r;i<n.length;i++)if(ei[e].test(n[i]))return i;return null},ni._getNodeByIndex=function(t,e){return e<0?t[t.length+e]:t[e]},new ni);function ii(t,e){return new c.nativeMethods.Function("fnCode","__dependencies$","Promise","RegExp",'"use strict"; return eval(fnCode)')(t,e,c.Promise,RegExp)}var oi=(si.prototype.shouldTransform=function(t){return"function"===t},si.prototype.toSerializable=function(){return""},si.prototype.fromSerializable=function(t){var e=t.fnCode,n=t.dependencies;return"filterOptions"in n&&(n.selectorFilter=ri),ii(e,n)},si);function si(){this.type="Function"}var ai=(li.prototype.shouldTransform=function(t,e){if(e instanceof c.nativeMethods.Node)throw new Nt(this._instantiationCallsiteName);return!1},li.prototype.toSerializable=function(){},li.prototype.fromSerializable=function(){},li);function li(t){this.type="Node",this._instantiationCallsiteName=t}var ui=(ci.prototype.getResult=function(){var e=this;return c.Promise.resolve().then(function(){var t=e.replicator.decode(e.command.args);return e._executeFn(t)}).catch(function(t){throw t.isTestCafeError||(t=new jt(e.command.instantiationCallsiteName,t)),t})},ci.prototype.encodeResult=function(t){return this.replicator.encode(t)},ci.prototype._createReplicator=function(){return $r([new ai(this.command.instantiationCallsiteName),new oi])},ci.prototype._executeFn=function(t){return this.fn.apply(vc,t)},ci);function ci(t){this.command=t,this.replicator=this._createReplicator(),this.dependencies=this.replicator.decode(t.dependencies),this.fn=ii(t.fnCode,this.dependencies)}var di="appeared-dialog",hi="unexpected-dialog",pi="handler-error",fi=l.eventSandbox.message,mi=l.processScript,gi=l.nativeMethods,vi="testcafe|native-dialog-tracker|appeared-dialogs",wi="testcafe|native-dialog-tracker|unexpected-dialog",yi="testcafe|native-dialog-tracker|error-in-handler",_i=mi("window.location.href"),Ei=(Object.defineProperty(Ci.prototype,"appearedDialogs",{get:function(){var t=this.contextStorage.getItem(vi);return t||(t=[],this.appearedDialogs=t),t},set:function(t){this.contextStorage.setItem(vi,t)},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"unexpectedDialog",{get:function(){return this.contextStorage.getItem(wi)},set:function(t){this.contextStorage.setItem(wi,t)},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"handlerError",{get:function(){return this.contextStorage.getItem(yi)},set:function(t){this.contextStorage.setItem(yi,t)},enumerable:!1,configurable:!0}),Ci._getPageUrl=function(){return gi.eval(_i)},Ci.prototype._initListening=function(){var n=this;fi.on(fi.SERVICE_MSG_RECEIVED_EVENT,function(t){var e=t.message;e.type===di?n._addAppearedDialogs(e.dialogType,e.text,e.url):e.type!==hi||n.unexpectedDialog?e.type!==pi||n.handlerError||n._onHandlerError(e.dialogType,e.message,e.url):n.unexpectedDialog={type:e.dialogType,url:e.url}})},Ci.prototype._init=function(t){var e=this;t&&["alert","confirm","prompt"].forEach(function(t){e.nativeHandlers[t]=vc[t]}),l.on(l.EVENTS.beforeUnload,function(t){t.prevented&&!t.isFakeIEEvent&&(e.dialogHandler?e._createDialogHandler("beforeunload")(t.returnValue||""):e._defaultDialogHandler("beforeunload")),e.contextStorage&&e.contextStorage.save()}),vc.alert=function(){return e._defaultDialogHandler("alert")},vc.confirm=function(){return e._defaultDialogHandler("confirm")},vc.prompt=function(){return e._defaultDialogHandler("prompt")}},Ci.prototype._createDialogHandler=function(i){var o=this;return function(t){var e=Ci._getPageUrl();o._addAppearedDialogs(i,t,e);var n=new ui(o.dialogHandler),r=null;try{r=n.fn.apply(vc,[i,t,e])}catch(t){o._onHandlerError(i,t.message||String(t),e)}return o.nativeHandlers[i]&&o.nativeHandlers[i].call(vc,t),r}},Ci.prototype._defaultDialogHandler=function(t){var e=Ci._getPageUrl();this.unexpectedDialog=this.unexpectedDialog||{type:t,url:e}},Ci.prototype._addAppearedDialogs=function(t,e,n){this.appearedDialogs.splice(0,0,{type:t,text:e,url:n})},Ci.prototype._onHandlerError=function(t,e,n){this.handlerError=this.handlerError||{type:t,message:e,url:n}},Ci.prototype.setHandler=function(t){var e=this;this.dialogHandler=t,["alert","confirm","prompt"].forEach(function(t){vc[t]=e.dialogHandler?e._createDialogHandler(t):function(){return e._defaultDialogHandler(t)}})},Ci.prototype.getUnexpectedDialogError=function(){var t=this.unexpectedDialog,e=this.handlerError;return this.unexpectedDialog=null,this.handlerError=null,t?new Fr(t.type,t.url):e?new Lr(e.type,e.message,e.url):null},Ci);function Ci(t,e){var n=void 0===e?{}:e,r=n.proxyless,i=n.dialogHandler;this.contextStorage=t,this.dialogHandler=i,this.nativeHandlers={},this._init(r),this._initListening(),this.dialogHandler&&this.setHandler(i)}function Ii(){return c.nativeMethods.performanceNow().toString()}function Si(t){this.type=t,this.id=Ii()}var bi,Wi="driver|establish-connection",Ti="driver|switch-to-window",Ai="driver|close-window",xi="driver|close-window-validation",Ri="driver|switch-to-window-validation",Ni="driver|get-windows",Di="driver|command-executed",Pi="driver|execute-command",Mi="driver|confirmation",Fi="driver|set-native-dialog-handler",ki="driver|set-as-master",Oi="driver|close-all-child-windows",Li="driver|start-to-restore-child-link",Ui="driver|restore-child-link",Hi="driver|child-window-is-loaded-in-iframe",Bi="driver|child-window-is-opened-in-iframe",Gi="driver|stop-internal-from-iframe",Vi="driver|has-pending-action-flags",qi=(t(zi,bi=Si),zi);function zi(){return bi.call(this,Wi)||this}var ji,Xi=(t(Yi,ji=Si),Yi);function Yi(t){var e=t.windowId,n=ji.call(this,xi)||this;return n.windowId=e,n}var Ki,Ji=(t($i,Ki=Si),$i);function $i(t){var e=t.windowId,n=t.fn,r=Ki.call(this,Ri)||this;return r.windowId=e,r.fn=n,r}var Qi,Zi=(t(to,Qi=Si),to);function to(){return Qi.call(this,Ni)||this}var eo,no=(t(ro,eo=Si),ro);function ro(t){var e=t.windowId,n=t.isCurrentWindow,r=eo.call(this,Ai)||this;return r.windowId=e,r.isCurrentWindow=n,r}var io,oo=(t(so,io=Si),so);function so(t){var e=t.windowId,n=t.fn,r=io.call(this,Ti)||this;return r.windowId=e,r.fn=n,r}var ao,lo=(t(uo,ao=Si),uo);function uo(t){var e=ao.call(this,Di)||this;return e.driverStatus=t,e}var co,ho=(t(po,co=Si),po);function po(t,e){var n=co.call(this,Pi)||this;return n.command=t,n.testSpeed=e,n}var fo,mo=(t(go,fo=Si),go);function go(t,e){var n=fo.call(this,Mi)||this;return n.requestMessageId=t,n.result=e,n}var vo,wo=(t(yo,vo=Si),yo);function yo(t){var e=vo.call(this,Fi)||this;return e.dialogHandler=t,e}var _o,Eo=(t(Co,_o=Si),Co);function Co(t){var e=_o.call(this,ki)||this;return e.finalizePendingCommand=t,e}var Io,So=(t(bo,Io=Si),bo);function bo(){return Io.call(this,Oi)||this}var Wo,To=(t(Ao,Wo=Si),Ao);function Ao(){return Wo.call(this,Li)||this}var xo,Ro=(t(No,xo=Si),No);function No(t){var e=xo.call(this,Ui)||this;return e.windowId=t,e}var Do,Po=(t(Mo,Do=Si),Mo);function Mo(t){var e=Do.call(this,Hi)||this;return e.windowId=t,e}var Fo,ko=(t(Oo,Fo=Si),Oo);function Oo(){return Fo.call(this,Bi)||this}var Lo,Uo=(t(Ho,Lo=Si),Ho);function Ho(){return Lo.call(this,Gi)||this}var Bo,Go=(t(Vo,Bo=Si),Vo);function Vo(){return Bo.call(this,Vi)||this}var qo=l.json,zo=l.nativeMethods,jo="%proxylessContextStorage%",Xo=(Yo.prototype._createStorageKey=function(t,e){var n="testcafe|driver|"+t;return e?n+"|"+e:n},Yo.prototype.loadFromStorage=function(){var t={},e=this._getData();return e&&(t=qo.parse(e),this._deleteData()),t},Yo.prototype._getData=function(){return zo.storageGetItem.call(this.storage,this.storageKey)},Yo.prototype._deleteData=function(){zo.storageRemoveItem.call(this.storage,this.storageKey)},Yo.prototype.save=function(t){zo.storageSetItem.call(this.storage,this.storageKey,qo.stringify(t))},Yo.prototype.dispose=function(){zo.storageRemoveItem.call(this.storage,this.storageKey)},Yo);function Yo(t,e,n){this.storage=zo.winSessionStorageGetter.call(t),this.storageKey=this._createStorageKey(e,n)}var Ko,Jo=(t($o,Ko=Xo),$o.prototype._getData=function(){return Ko.prototype._getData.call(this)||vc[jo]},$o.prototype._deleteData=function(){Ko.prototype._deleteData.call(this),vc[jo]=null},$o.prototype.save=function(t){Ko.prototype.save.call(this,t),vc.PROXYLESS_STORAGE_BINDING&&vc.PROXYLESS_STORAGE_BINDING(qo.stringify(t))},$o);function $o(){return null!==Ko&&Ko.apply(this,arguments)||this}var Qo=(Zo.prototype._createStorageStrategy=function(t,e,n,r){return new(t?Jo:Xo)(e,n,r)},Zo.prototype.save=function(){this.strategy.save(this.data)},Zo.prototype.setItem=function(t,e){this.data[t]=e,this.save(this.data)},Zo.prototype.getItem=function(t){return this.data[t]},Zo.prototype.dispose=function(){this.strategy.dispose()},Zo);function Zo(t,e){var n=e.testRunId,r=e.windowId,i=e.proxyless;this.strategy=this._createStorageStrategy(i,t,n,r),this.data=this.strategy.loadFromStorage()}var ts=Object.prototype.toString,es=String.prototype.indexOf,ns=String.prototype.endsWith||function(t,e){var n=ts.call(this);(void 0===e||e>n.length)&&(e=n.length),e-=t.length;var r=es.call(n,t,e);return-1!==r&&r===e},rs=Array.prototype.indexOf,is=Array.prototype.map,os=Array.prototype.sort,ss=Array.prototype.filter,as=Array.prototype.concat,ls="Command",us=(cs.prototype.getAssignableProperties=function(){return[]},cs.prototype.getAllAssignableProperties=function(){for(var t=Object.getPrototypeOf(this),e=[];t&&t.getAssignableProperties;)e=as.call(e,t.getAssignableProperties()),t=Object.getPrototypeOf(t);return e},cs.prototype.getNonReportedProperties=function(){return[]},cs.prototype.getReportedProperties=function(){var t=is.call(this.getAllAssignableProperties(),function(t){return t.name}),e=this.getNonReportedProperties();return ss.call(t,function(t){return!(-1<rs.call(e,t))})},cs.prototype._assignFrom=function(t,e,n){if(void 0===n&&(n={}),t){e&&function(t,e){var n,r=e.constructor.name,i=is.call(e.getAllAssignableProperties(),function(t){return t.name}),o=os.call(e.getReportedProperties());for(n in t)if(!(-1<rs.call(i,n)||n in e))throw new He(r,n,o)}(t,this);for(var r,i,o=this.getAllAssignableProperties(),s=0;s<o.length;s++){var a=o[s],l=a.name,u=a.type,c=a.required,d=a.init,h=a.defaultValue;void 0!==h&&(this[l]=h);var p=t[l];void 0===p&&!c||(e&&u&&u((r=this.constructor.name,i=l,ns.call(r,ls)?i:"".concat(r,".").concat(i)),p),this[l]=d?d(l,p,n,e):p)}}},cs);function cs(){}var ds,hs=(t(ps,ds=us),ps.prototype.getAssignableProperties=function(){return[{name:"isCommandResult"},{name:"executionError"},{name:"pageError"},{name:"result"},{name:"consoleMessages"},{name:"isPendingWindowSwitching"},{name:"isObservingFileDownloadingInNewWindow"},{name:"isFirstRequestAfterWindowSwitching"},{name:"warnings"}]},ps);function ps(t){var e=ds.call(this,t)||this;return e.id=Ii(),e.isCommandResult=!1,e.executionError=null,e.pageError=null,e.resent=!1,e.result=null,e.consoleMessages=null,e.isPendingWindowSwitching=!1,e.isObservingFileDownloadingInNewWindow=!1,e.isFirstRequestAfterWindowSwitching=!1,e.debug="",e.warnings=null,e._assignFrom(t,!0),e}function fs(n,t,e,r){var i=null,o=null,s=null;return e=Math.max(e||0,2500),c.Promise.race([_.delay(e),new c.Promise(function(e){s=function(t){t.message.type===Mi&&t.message.requestMessageId===n.id&&e(t.message)},c.eventSandbox.message.on(c.eventSandbox.message.SERVICE_MSG_RECEIVED_EVENT,s),i=c.nativeMethods.setInterval.call(vc,function(){return c.eventSandbox.message.sendServiceMsg(n,t)},1e3),c.eventSandbox.message.sendServiceMsg(n,t)})]).then(function(t){if(c.nativeMethods.clearInterval.call(vc,i),c.nativeMethods.clearTimeout.call(vc,o),c.eventSandbox.message.off(c.eventSandbox.message.SERVICE_MSG_RECEIVED_EVENT,s),!t)throw new r;return t})}var ms=2e4;function gs(t){var e=t.requestMsgId,n=t.result,r=t.window,i=new mo(e,n);c.eventSandbox.message.sendServiceMsg(i,r)}var vs=(Object.defineProperty(ws.prototype,"availabilityTimeout",{set:function(t){this.iframeAvailabilityTimeout=t},enumerable:!1,configurable:!0}),ws.prototype._ensureIframe=function(){var t=this;return _.domUtils.isElementInDocument(this.driverIframe)?_.waitFor(function(){return _.positionUtils.isIframeVisible(t.driverIframe)?t.driverIframe:null},200,this.iframeAvailabilityTimeout).catch(function(){throw new Dr}):c.Promise.reject(new xr)},ws.prototype._waitForIframeRemovedOrHidden=function(){var e=this;return new c.Promise(function(t){e.checkIframeInterval=c.nativeMethods.setInterval.call(vc,function(){e._ensureIframe().catch(function(){return _.delay(500).then(function(){return t(new hs({isCommandResult:!0}))})})},1e3)})},ws.prototype._waitForCommandResult=function(){var e=this,n=null;return c.Promise.race([this._waitForIframeRemovedOrHidden(),new c.Promise(function(e){n=function(t){t.message.type===Di&&e(t.message.driverStatus)},c.eventSandbox.message.on(c.eventSandbox.message.SERVICE_MSG_RECEIVED_EVENT,n)})]).then(function(t){return c.eventSandbox.message.off(c.eventSandbox.message.SERVICE_MSG_RECEIVED_EVENT,n),c.nativeMethods.clearInterval.call(vc,e.checkIframeInterval),t})},ws.prototype.sendConfirmationMessage=function(t){gs({requestMsgId:t,result:{id:this.driverId,dispatchProxylessEventUrl:this.dispatchProxylessEventUrl},window:this.driverWindow})},ws.prototype.executeCommand=function(e,n){var r=this;return this._ensureIframe().then(function(){var t=new ho(e,n);return c.Promise.all([fs(t,r.driverWindow,r.iframeAvailabilityTimeout,qn),r._waitForCommandResult()])}).then(function(t){return t[1]})},ws);function ws(t,e,n){this.driverWindow=t,this.driverIframe=_.domUtils.findIframeByWindow(t),this.driverId=e,this.iframeAvailabilityTimeout=0,this.dispatchProxylessEventUrl=n}var ys=["nodeType","textContent","childNodeCount","hasChildNodes","childElementCount","hasChildElements"],_s=["tagName","attributes"],Es=["tagName","visible","focused","attributes","boundingClientRect","classNames","style","innerText","namespaceURI","id","value","checked","selected","selectedIndex","scrollWidth","scrollHeight","scrollLeft","scrollTop","offsetWidth","offsetHeight","offsetLeft","offsetTop","clientWidth","clientHeight","clientLeft","clientTop"],Cs={childNodeCount:function(t){return t.childNodes.length},hasChildNodes:function(t){return!!Cs.childNodeCount(t)},childElementCount:function(t){var e=t.children;if(e)return e.length;for(var n=0,r=t.childNodes.length,i=0;i<r;i++)1===t.childNodes[i].nodeType&&n++;return n},hasChildElements:function(t){return!!Cs.childElementCount(t)}},Is=(Ss.prototype._initializeProperties=function(t,e,n){for(var r=0,i=e;r<i.length;r++){var o=i[r],s=n[o];this[o]=s?s(t):t[o]}},Ss);function Ss(){}var bs,Ws=(t(Ts,bs=Is),Ts);function Ts(t){var e=bs.call(this)||this;return e._initializeProperties(t,ys,Cs),e}var As,xs={tagName:function(t){return t.tagName.toLowerCase()},visible:function(t){return _.positionUtils.isElementVisible(t)},focused:function(t){return c.utils.dom.getActiveElement()===t},attributes:function(t){for(var e=t.attributes,n={},r=e.length-1;0<=r;r--)n[e[r].name]=e[r].value;return n},boundingClientRect:function(t){var e=t.getBoundingClientRect();return{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width,height:e.height}},classNames:function(t){var e=t.className;return"string"==typeof e.animVal&&(e=e.animVal),e.replace(/^\s+|\s+$/g,"").split(/\s+/g)},style:function(t){for(var e={},n=vc.getComputedStyle(t),r=0;r<n.length;r++){var i=n[r];e[i]=n[i]}return e},innerText:function(t){return t.innerText}},Rs=(t(Ns,As=Is),Ns);function Ns(t){var e=As.call(this)||this;return e._initializeProperties(t,_s,xs),e}var Ds,Ps=(t(Ms,Ds=Ws),Ms);function Ms(t){var e=Ds.call(this,t)||this;return e._initializeProperties(t,Es,xs),e}var Fs=(ks.prototype._extend=function(t,e){for(var n=0,r=c.nativeMethods.objectKeys(this._customDOMProperties);n<r.length;n++){var i=r[n];try{t[i]=this._customDOMProperties[i](e)}catch(t){throw new Kt(this._instantiationCallsiteName,t,i)}}},ks.prototype.shouldTransform=function(t,e){return e instanceof c.nativeMethods.Node},ks.prototype.toSerializable=function(t){var e=new(1===t.nodeType?Ps:Ws)(t);return this._extend(e,t),e},ks.prototype.fromSerializable=function(){},ks);function ks(t,e){void 0===t&&(t={}),this.type="Node",this._customDOMProperties=t,this._instantiationCallsiteName=e}var Os=(Ls.prototype.on=function(t,e){this._eventsListeners[t]||(this._eventsListeners[t]=[]),this._eventsListeners[t].push(e)},Ls.prototype.once=function(n,r){var i=this;this.on(n,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return i.off(n,r),r.apply(void 0,t)})},Ls.prototype.off=function(t,e){var n=this._eventsListeners[t];n&&(this._eventsListeners[t]=c.nativeMethods.arrayFilter.call(n,function(t){return t!==e}))},Ls.prototype.offAll=function(t){t?this._eventsListeners[t]=[]:this._eventsListeners={}},Ls.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this._eventsListeners[e];if(r)for(var i=0;i<r.length;i++)try{r[i].apply(this,t)}catch(t){if(!(t.message&&-1<t.message.indexOf("freed script")))throw t;this.off(e,r[i])}},Ls);function Ls(){this._eventsListeners={}}var Us=l.Promise,Hs=l.nativeMethods;function Bs(e){return new Us(function(t){return Hs.setTimeout.call(vc,t,e)})}var Gs={1:"element",2:"attribute",3:"text",4:"cdata section",5:"entity reference",6:"entity node",7:"processing instruction",8:"comment",9:"document",10:"document type",11:"document fragment",12:"notation"};function Vs(t){return t?{name:"ActionAdditionalElementIsInvisibleError",firstArg:t}:"ActionElementIsInvisibleError"}function qs(t){return t?{name:"ActionAdditionalElementNotFoundError",firstArg:t}:"ActionElementNotFoundError"}function zs(t){var e="string"==typeof t?Hr[t]:Hr[t.name],n="string"==typeof t?null:t.firstArg;return function(t){return new e(n,t)}}var js=(Xs.prototype.push=function(t,r){var i=this;this._ensureElementsPromise=this._ensureElementsPromise.then(function(){return i._executeSelectorFn(t,{invisible:Vs(r),notFound:qs(r)},i._ensureElementsStartTime)}).then(function(t){if(!_.domUtils.isDomElement(t)){var e=t.nodeType,n=Gs[e];throw r?new ln(r,n):new Ke(n)}i._elements.push(t)})},Xs.prototype.getElements=function(){var t=this;return this._ensureElementsPromise.then(function(){return t._elements})},Xs);function Xs(t,e){this._globalSelectorTimeout=t,this._ensureElementsStartTime=c.nativeMethods.dateNow(),this._ensureElementsPromise=c.Promise.resolve(),this._executeSelectorFn=e,this._elements=[]}var Ys=(Ks.create=function(t){return new Ks(t.top,t.right,t.bottom,t.left)},Ks.prototype.add=function(t){return this.top+=t.top,this.right+=t.right,this.bottom+=t.bottom,this.left+=t.left,this},Ks.prototype.sub=function(t){return"top"in t&&(this.top-=t.top,this.left-=t.left),this.bottom-=t.bottom,this.right-=t.right,this},Ks.prototype.round=function(t,e){return void 0===t&&(t=Math.round),void 0===e&&(e=t),this.top=t(this.top),this.right=e(this.right),this.bottom=e(this.bottom),this.left=t(this.left),this},Ks.prototype.contains=function(t){return t.x>=this.left&&t.x<=this.right&&t.y>=this.top&&t.y<=this.bottom},Ks);function Ks(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.top=t,this.right=e,this.bottom=n,this.left=r}function Js(t){var e="array"+t.charAt(0).toUpperCase()+t.slice(1),n=c.nativeMethods[e];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.call.apply(n,t)}}Js("filter"),Js("map"),Js("slice"),Js("splice"),Js("unshift"),Js("forEach"),Js("indexOf"),Js("some"),Js("reverse"),Js("reduce"),Js("concat"),Js("join"),l.utils.browser,l.nativeMethods,l.utils.style.get,l.utils.dom.getActiveElement,l.utils.dom.findDocument,l.utils.dom.find,l.utils.dom.isElementInDocument;var $s=l.utils.dom.isElementInIframe,Qs=l.utils.dom.getIframeByElement,Zs=(l.utils.dom.isCrossDomainWindows,l.utils.dom.getSelectParent,l.utils.dom.getChildVisibleIndex,l.utils.dom.getSelectVisibleChildren,l.utils.dom.isElementNode,l.utils.dom.isTextNode,l.utils.dom.isRenderedNode,l.utils.dom.isIframeElement,l.utils.dom.isInputElement,l.utils.dom.isButtonElement,l.utils.dom.isFileInput,l.utils.dom.isTextAreaElement,l.utils.dom.isAnchorElement,l.utils.dom.isImgElement,l.utils.dom.isFormElement,l.utils.dom.isLabelElement,l.utils.dom.isSelectElement,l.utils.dom.isRadioButtonElement,l.utils.dom.isColorInputElement,l.utils.dom.isCheckboxElement,l.utils.dom.isOptionElement,l.utils.dom.isSVGElement,l.utils.dom.isMapElement,l.utils.dom.isBodyElement,l.utils.dom.isHtmlElement),ta=(l.utils.dom.isDocument,l.utils.dom.isWindow,l.utils.dom.isTextEditableInput,l.utils.dom.isTextEditableElement,l.utils.dom.isTextEditableElementAndEditingAllowed,l.utils.dom.isContentEditableElement,l.utils.dom.isDomElement,l.utils.dom.isShadowUIElement,l.utils.dom.isShadowRoot,l.utils.dom.isElementFocusable,l.utils.dom.isHammerheadAttr,l.utils.dom.isElementReadOnly,l.utils.dom.getScrollbarSize),ea=(l.utils.dom.getMapContainer,l.utils.dom.getTagName,l.utils.dom.closest,l.utils.dom.getParents,l.utils.dom.findParent,l.utils.dom.getTopSameDomainWindow,l.utils.dom.getParentExceptShadowRoot,l.utils.style,l.utils.style.getBordersWidth),na=(l.utils.style.getComputedStyle,l.utils.style.getElementMargin,l.utils.style.getElementPadding,l.utils.style.getElementScroll),ra=(l.utils.style.getOptionHeight,l.utils.style.getSelectElementSize,l.utils.style.isElementVisible,l.utils.style.isVisibleChild,l.utils.style.getWidth,l.utils.style.getHeight,l.utils.style.getInnerWidth),ia=l.utils.style.getInnerHeight,oa=(l.utils.style.getScrollLeft,l.utils.style.getScrollTop,l.utils.style.setScrollLeft,l.utils.style.setScrollTop,l.utils.style.get,l.shadowUI,l.nativeMethods,sa.create=function(t){return"left"in t?new sa(t.left,t.top):"right"in t?new sa(t.right,t.bottom):new sa(t.x,t.y)},sa.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},sa.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},sa.prototype.round=function(t){return void 0===t&&(t=Math.round),this.x=t(this.x),this.y=t(this.y),this},sa.prototype.eql=function(t){return this.x===t.x&&this.y===t.y},sa.prototype.mul=function(t){return this.x*=t,this.y*=t,this},sa.prototype.distance=function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},sa);function sa(t,e){this.x=t,this.y=e}var aa=function(t,e,n,r,i,o){this.width=t,this.height=e,this.left=n.x,this.top=n.y,this.right=n.x+t,this.bottom=n.y+e,this.border=r,this.scrollbar=o,this.scroll=i},la=(l.utils.html,l.nativeMethods,l.utils.position.getElementRectangle),ua=l.utils.position.getOffsetPosition,ca=l.utils.position.offsetToClientCoords;function da(t){var e=t/2;return e<1?0:Math.round(e)}function ha(t,e,n){var r,i={offsetX:da((r=la(t)).width),offsetY:da(r.height)};if(e="number"==typeof e?Math.round(e):i.offsetX,n="number"==typeof n?Math.round(n):i.offsetY,0<e&&0<n)return{offsetX:e,offsetY:n};var o=function(t){var e,n,r,i,o=Zs(t),s=o?t.getElementsByTagName("body")[0]:null,a=t.getBoundingClientRect(),l=Ys.create(ea(t)),u=na(t),c=$s(t),d="BackCompat"===t.ownerDocument.compatMode,h=o?new oa(0,0):oa.create(a),p=a.height,f=a.width;o&&(f=s&&d?(p=s.clientHeight,s.clientWidth):(p=t.clientHeight,t.clientWidth)),!c||(e=Qs(t))&&(n=ua(e),r=ca(oa.create(n)),i=ea(e),h.add(r).add(oa.create(i)),o&&l.add(i));var m=!o&&ra(t)!==t.clientWidth,g=!o&&ia(t)!==t.clientHeight,v={right:m?ta():0,bottom:g?ta():0};return new aa(f,p,h,l,u,v)}(t),s=Math.round(Math.max(t.scrollWidth,o.width)),a=Math.round(Math.max(t.scrollHeight,o.height)),l=o.scrollbar.right+o.border.left+o.border.right+s,u=o.scrollbar.bottom+o.border.top+o.border.bottom+a;return{offsetX:e<0?l+e:e,offsetY:n<0?u+n:n}}var pa,fa=(t(ma,pa=Os),ma.prototype._prepareCommand=function(t,e){t.options&&!t.options.speed&&(t.options.speed=e.testSpeed)},ma.prototype._getCommandSelectorTimeout=function(t,e){var n;return"number"==typeof(null===(n=t.selector)||void 0===n?void 0:n.timeout)?t.selector.timeout:e.globalSelectorTimeout},ma.prototype._delayAfterExecution=function(){return this._command.options&&1!==this._command.options.speed?Bs(2e3*(1-this._command.options.speed)):c.Promise.resolve()},ma.prototype._isExecutionTimeoutExpired=function(){return c.nativeMethods.dateNow()-this._executionStartTime>=this._commandSelectorTimeout},ma.prototype._ensureCommandArguments=function(){var t=ma.ACTIONS_HANDLERS[this._command.type];null!=t&&t.ensureCmdArgs&&t.ensureCmdArgs(this._command)},ma.prototype._ensureCommandElements=function(){var t,e=this,n=new js(this._options.globalSelectorTimeout,this._options.executeSelectorFn);this._command.selector&&n.push(this._command.selector);var r=null===(t=ma.ACTIONS_HANDLERS[this._command.type])||void 0===t?void 0:t.additionalSelectorProps;if(r)for(var i=0,o=r;i<o.length;i++){var s=o[i];this._command[s]&&n.push(this._command[s],s)}return n.getElements().then(function(t){e._elements=t})},ma.prototype._ensureCommandElementsProperties=function(){var t=ma.ACTIONS_HANDLERS[this._command.type];null!=t&&t.ensureElsProps&&t.ensureElsProps(this._elements)},ma.prototype._ensureCommandOptions=function(){return s(this,void 0,c.Promise,function(){var e,n,r,i;return C(this,function(t){return e=this._command.options,this._elements.length&&e&&"offsetX"in e&&"offsetY"in e&&(n=ha(this._elements[0],e.offsetX,e.offsetY),r=n.offsetX,i=n.offsetY,e.isDefaultOffset=!e.offsetX&&!e.offsetY,e.offsetX=r,e.offsetY=i),[2]})})},ma.prototype._createAutomation=function(){var t=ma.ACTIONS_HANDLERS[this._command.type];if(!t)throw new Error('There is no handler for the "'.concat(this._command.type,'" command.'));return t.create(this._command,this._elements,this._options.dispatchProxylessEventFn)},ma.prototype._runAction=function(e){var n=this;return this._ensureCommandElements().then(function(){return n._ensureCommandElementsProperties()}).then(function(){return n._ensureCommandOptions()}).then(function(){var t=n._createAutomation();return t.WARNING_EVENT&&t.on(t.WARNING_EVENT,function(t){n.emit(ma.WARNING_EVENT,t)}),t.TARGET_ELEMENT_FOUND_EVENT?t.on(t.TARGET_ELEMENT_FOUND_EVENT,function(t){n._targetElement=t.element,n.emit(ma.EXECUTION_STARTED_EVENT)}):n.emit(ma.EXECUTION_STARTED_EVENT),t.run(e)})},ma.prototype._runRecursively=function(){var e=this,t=!1,n=!0;return function(e,n){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return e()?[4,n()]:[3,2];case 1:return t.sent(),[3,0];case 2:return[2]}})})}(function(){return!t},function(){return e._runAction(n).then(function(){t=!0}).catch(function(t){if(!e._isExecutionTimeoutExpired())return Bs(250);if(t.code===St)return n=!1,c.Promise.resolve();throw t})})},ma.prototype.execute=function(t){var e=this;this._executionStartTime=c.nativeMethods.dateNow();try{this._ensureCommandArguments()}catch(t){return c.Promise.reject(t)}return this.emit(ma.WAITING_FOR_ELEMENT_EVENT,this._commandSelectorTimeout),this._runRecursively().then(function(){return c.Promise.all([e._delayAfterExecution(),t.wait()])}).then(function(){var t=function(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||((r=r||Array.prototype.slice.call(e,0,i))[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}([],e._elements,!0);return e._targetElement&&(t[0]=e._targetElement),t})},ma.EXECUTION_STARTED_EVENT="execution-started",ma.WAITING_FOR_ELEMENT_EVENT="waiting-for-elements",ma.WARNING_EVENT="warning",ma.ACTIONS_HANDLERS={},ma);function ma(t,e){var n=pa.call(this)||this;return n._command=t,n._targetElement=null,n._elements=[],n._options=e,n._executionStartTime=0,n._prepareCommand(t,e),n._commandSelectorTimeout=n._getCommandSelectorTimeout(t,e),n}function ga(t,e,n){return Math.min(Math.max(e,t),n)}function va(t,e){var n="number"==typeof t.min,r="number"==typeof t.max,i="number"==typeof t.length;return i&&(t.length=ga(t.length,0,e)),n&&t.min<0&&(t.min+=e),r&&t.max<0&&(t.max+=e),n||(t.min=r&&i?t.max-t.length:0),r||(t.max=i?t.min+t.length:e),t.min=ga(t.min,0,e),t.max=ga(t.max,0,e),t.length=t.max-t.min,t}function wa(t,e,n){return Math.round(t+ga(e-t,0,n)/2)}var ya,_a=(t(Ea,ya=ui),Ea.prototype._createReplicator=function(){return $r([new oi])},Ea.prototype._getTimeoutErrorParams=function(t){return{apiFnIndex:ri.error,apiFnChain:this.command.apiFnChain,reason:_.positionUtils.getHiddenReason(t)}},Ea.prototype._getTimeoutError=function(t){return t?this.createIsInvisibleError:this.createNotFoundError},Ea.prototype._validateElement=function(s,a){var l=this;return c.Promise.resolve().then(function(){return ya.prototype._executeFn.call(l,s)}).then(function(t){var e=t,n=!!e,r=!l.command.visibilityCheck||e&&_.positionUtils.isElementVisible(e),i=c.nativeMethods.dateNow()-a>=l.timeout;if(n&&(r||c.utils.dom.isShadowRoot(e)))return e;if(!i)return _.delay(200).then(function(){return l._validateElement(s,a)});var o=l.getVisibleValueMode?null:l._getTimeoutError(n);if(o)throw o(l._getTimeoutErrorParams(e));return null})},Ea.prototype._executeFn=function(t){return this.counterMode?ya.prototype._executeFn.call(this,t):this._validateElement(t,c.nativeMethods.dateNow())},Ea);function Ea(t,e,n,r,i){var o,s=ya.call(this,t)||this;s.createNotFoundError=r,s.createIsInvisibleError=i,s.timeout="number"==typeof t.timeout?t.timeout:e,s.counterMode=s.dependencies.filterOptions.counterMode,s.getVisibleValueMode=s.dependencies.filterOptions.getVisibleValueMode,s.dependencies.selectorFilter=ri,n&&(o=c.nativeMethods.dateNow()-n,s.timeout=Math.max(s.timeout-o,0));var a=s.dependencies.customDOMProperties;return s.replicator.addTransforms([new Fs(a,t.instantiationCallsiteName)]),s}var Ca=c.nativeMethods.date,Ia=(Sa.prototype._ensureElement=function(t){var e=this,n=t.selector,r=t.createNotFoundError,i=t.createIsInvisibleError,o=t.createHasWrongNodeTypeError;this.ensureElementsPromise=this.ensureElementsPromise.then(function(){return new _a(n,e.globalSelectorTimeout,e.ensureElementsStartTime,r,i).getResult()}).then(function(t){if(!_.domUtils.isDomElement(t))throw o(Gs[t.nodeType]);e.elements.push(t)})},Sa.prototype.getElements=function(){var t=this;return this.ensureElementsPromise.then(function(){return t.elements})},Sa);function Sa(t,e){var n=this;this.elements=[],this.globalSelectorTimeout=e,this.ensureElementsPromise=c.Promise.resolve(),this.ensureElementsStartTime=new Ca,t.forEach(function(t){return n._ensureElement(t)})}function ba(r){return function(t,e){var n=typeof e;if("number"!=n)throw new r(t,n);if(isNaN(e)||!isFinite(e)||e!==Math.floor(e))throw new r(t,e)}}var Wa,Ta,Aa,xa,Ra,Na,Da,Pa,Ma,Fa,ka,Oa,La,Ua=ba(ie),Ha=(Ta=ba(Wa=ae),function(t,e){if(Ta(t,e),e<0)throw new Wa(t,e)}),Ba=(Aa=ce,function(t,e){var n=typeof e;if("boolean"!=n)throw new Aa(t,n)}),Ga=(xa=pe,function(t,e){var n=typeof e;if("number"!=n)throw new xa(t,n);if(isNaN(e)||e<.01||1<e)throw new xa(t,e)}),Va=(Ra=ge,function(t,e){var n=typeof e;if("string"!=n)throw new Ra(t,n)}),qa=(Na=ye,function(t,e){var n=typeof e;if("string"!=n&&!(e instanceof RegExp))throw new Na(t,n)}),za=(Da=Ce,function(t,e){if(!(e instanceof Date))throw new Da(t,e)}),ja=(Pa=be,function(t,e){if(isNaN(Number(e)))throw new Pa(t,typeof e)}),Xa=(Ma=Ae,function(t,e){var n=typeof e;if("string"!=n&&!(e instanceof URL))throw new Ma(t,n)}),Ya=(Fa=Ne,function(t,e){var n=typeof e;if("object"!=n&&!(e instanceof URLSearchParams))throw new Fa(t,n)}),Ka=(ka=Me,function(t,e){var n=typeof e;if("object"!=n)throw new ka(t,n)}),Ja=(Oa=Oe,function(t,e){var n=typeof e;if("function"!=n)throw new Oa(t,n)}),$a=(t(Qa,La=us),Qa.prototype.getAssignableProperties=function(){return[{name:"speed",type:Ga}]},Qa);function Qa(t,e){var n=La.call(this)||this;return n.speed=null,n._assignFrom(t,e),n}var Za,tl=(t(el,Za=$a),el.prototype.getAssignableProperties=function(){return[{name:"offsetX",type:Ua},{name:"offsetY",type:Ua},{name:"isDefaultOffset",type:Ba}]},el);function el(t,e){var n=Za.call(this)||this;return n.offsetX=null,n.offsetY=null,n._assignFrom(t,e),n}var nl,rl=(t(il,nl=tl),il.prototype.getAssignableProperties=function(){return[{name:"scrollToCenter",type:Ba},{name:"skipParentFrames",type:Ba}]},il);function il(t,e){var n=nl.call(this)||this;return n.scrollToCenter=!1,n.skipParentFrames=!1,n._assignFrom(t,e),n}var ol,sl=(t(al,ol=us),al.prototype.getAssignableProperties=function(){return[{name:"left",type:Ua,defaultValue:null},{name:"right",type:Ua,defaultValue:null},{name:"top",type:Ua,defaultValue:null},{name:"bottom",type:Ua,defaultValue:null}]},al);function al(t,e){var n=ol.call(this)||this;return n._assignFrom(t,e),n}var ll,ul=(t(cl,ll=$a),cl.prototype.getAssignableProperties=function(){return[{name:"scrollTargetX",type:Ua},{name:"scrollTargetY",type:Ua},{name:"crop",type:Ka,init:Jl},{name:"includeMargins",type:Ba},{name:"includeBorders",type:Ba},{name:"includePaddings",type:Ba}]},cl);function cl(t,e){var n=ll.call(this)||this;return n.scrollTargetX=null,n.scrollTargetY=null,n.includeMargins=!1,n.includeBorders=!0,n.includePaddings=!0,n.crop={left:null,right:null,top:null,bottom:null},n._assignFrom(t,e),n}var dl,hl=(t(pl,dl=us),pl.prototype.getAssignableProperties=function(){return[{name:"ctrl",type:Ba,defaultValue:!1},{name:"alt",type:Ba,defaultValue:!1},{name:"shift",type:Ba,defaultValue:!1},{name:"meta",type:Ba,defaultValue:!1}]},pl);function pl(t,e){var n=dl.call(this)||this;return n._assignFrom(t,e),n}var fl,ml=(t(gl,fl=tl),gl.prototype.getAssignableProperties=function(){return[{name:"modifiers",type:Ka,init:$l}]},gl);function gl(t,e){var n=fl.call(this)||this;return n.modifiers={ctrl:!1,alt:!1,shift:!1,meta:!1},n._assignFrom(t,e),n}var vl,wl,yl,_l,El,Cl,Il,Sl,bl=(t(Wl,vl=ml),Wl.prototype.getAssignableProperties=function(){return[{name:"caretPos",type:Ha}]},Wl);function Wl(t,e){var n=vl.call(this)||this;return n.caretPos=null,n._assignFrom(t,e),n}function Tl(t,e){var n=wl.call(this)||this;return n.speed=null,n.minMovingTime=null,n.holdLeftButton=!1,n.skipScrolling=!1,n.skipDefaultDragBehavior=!1,n._assignFrom(t,e),n}function Al(t,e){var n=yl.call(this)||this;return n.replace=!1,n.paste=!1,n.confidential=void 0,n._assignFrom(t,e),n}function xl(t,e){var n=_l.call(this,t,e)||this;return n.destinationOffsetX=null,n.destinationOffsetY=null,n._assignFrom(t,e),n}function Rl(t,e){var n=El.call(this)||this;return n.portraitOrientation=!1,n._assignFrom(t,e),n}function Nl(t,e){var n=Cl.call(this)||this;return n.timeout=void 0,n.allowUnawaitedPromise=!1,n._assignFrom(t,e),n}function Dl(t,e){var n=Il.call(this)||this;return n.confidential=void 0,n._assignFrom(t,e),n}function Pl(t,e){var n=Sl.call(this)||this;return n._assignFrom(t,e),n}t(Tl,wl=ml),Tl.prototype.getAssignableProperties=function(){return[{name:"speed"},{name:"minMovingTime"},{name:"holdLeftButton"},{name:"skipScrolling",type:Ba},{name:"skipDefaultDragBehavior",type:Ba}]},t(Al,yl=bl),Al.prototype.getAssignableProperties=function(){return[{name:"replace",type:Ba},{name:"paste",type:Ba},{name:"confidential",type:Ba}]},t(xl,_l=ml),xl.prototype.getAssignableProperties=function(){return[{name:"destinationOffsetX",type:Ua},{name:"destinationOffsetY",type:Ua}]},t(Rl,El=us),Rl.prototype.getAssignableProperties=function(){return[{name:"portraitOrientation",type:Ba}]},t(Nl,Cl=us),Nl.prototype.getAssignableProperties=function(){return[{name:"timeout",type:Ha},{name:"allowUnawaitedPromise",type:Ba}]},t(Dl,Il=$a),Dl.prototype.getAssignableProperties=function(){return[{name:"confidential",type:Ba}]},t(Pl,Sl=us),Pl.prototype.getAssignableProperties=function(){return[{name:"name",type:Va},{name:"value",type:Va},{name:"domain",type:Va},{name:"path",type:Va},{name:"expires",type:za},{name:"maxAge",type:ja},{name:"secure",type:Ba},{name:"httpOnly",type:Ba},{name:"sameSite",type:Va}]};var Ml,Fl=(t(kl,Ml=us),kl.prototype.getAssignableProperties=function(){return[{name:"username",type:Va,required:!0},{name:"password",type:Va}]},kl);function kl(t,e){var n=Ml.call(this)||this;return n._assignFrom(t,e),n}var Ol,Ll,Ul,Hl,Bl,Gl=(t(Vl,Ol=us),Vl.prototype.getAssignableProperties=function(){return[{name:"protocol",type:Va},{name:"host",type:Va,required:!0},{name:"port",type:ja,required:!0},{name:"auth",type:Ka,init:Yl}]},Vl);function Vl(t,e){var n=Ol.call(this)||this;return n._assignFrom(t,e),n}function ql(t,e){var n=Ll.call(this)||this;return n._assignFrom(t,e),n}function zl(t,e){var n=Ul.call(this)||this;return n._assignFrom(t,e),n}function jl(t,e){var n=Hl.call(this)||this;return n._assignFrom(t,e),n}function Xl(t,e){var n=Bl.call(this)||this;return n._assignFrom(t,e),n}function Yl(t,e,n,r){return void 0===r&&(r=!0),new Fl(e,r)}function Kl(t,e,n,r){return void 0===r&&(r=!0),new Gl(e,r)}function Jl(t,e,n,r){return void 0===r&&(r=!0),new sl(e,r)}function $l(t,e,n,r){return void 0===r&&(r=!0),new hl(e,r)}function Ql(t){return t.top!==t}t(ql,Ll=us),ql.prototype.getAssignableProperties=function(){return[{name:"url",type:Xa},{name:"method",type:Va},{name:"headers",type:Ka},{name:"params",type:Ya},{name:"body"},{name:"timeout",type:ja},{name:"withCredentials",type:Ba},{name:"auth",type:Ka,init:Yl},{name:"proxy",type:Ka,init:Kl},{name:"rawResponse",type:Ba}]},t(zl,Ul=us),zl.prototype.getAssignableProperties=function(){return[{name:"credentials",type:ja}]},t(jl,Hl=us),jl.prototype.getAssignableProperties=function(){return[{name:"stack",type:qa,required:!1},{name:"message",type:qa,required:!1},{name:"pageUrl",type:qa,required:!1}]},t(Xl,Bl=us),Xl.prototype.getAssignableProperties=function(){return[{name:"fn",type:Ja,required:!0},{name:"dependencies",type:Ka,required:!1}]};var Zl=c.eventSandbox.message,tu="driver|browser-manipulation|request",eu="driver|browser-manipulation|response";Zl.on(Zl.SERVICE_MSG_RECEIVED_EVENT,function(e){var t,n,r,i,o;e.message.cmd===tu&&(t=_.domUtils.findIframeByWindow(e.source),r=(n=e.message).command,(i=n.cropDimensions)&&(r.options=new ul({crop:i,includePaddings:!1})),(o=new nu(r)).element=t,o.execute().then(function(t){return Zl.sendServiceMsg({cmd:eu,result:t},e.source)}))});var nu=(ru.prototype._getAbsoluteCropValues=function(){var t=this.element.getBoundingClientRect(),e=t.top,n=t.left;n+=this.command.options.originOffset.x,e+=this.command.options.originOffset.y;var r=n+this.command.options.crop.right,i=e+this.command.options.crop.bottom;return{top:e+=this.command.options.crop.top,left:n+=this.command.options.crop.left,bottom:i,right:r}},ru.prototype._createManipulationReadyMessage=function(){var t=vc.devicePixelRatio||1,e={cmd:u.readyForBrowserManipulation,pageDimensions:{dpr:t,innerWidth:vc.innerWidth,innerHeight:vc.innerHeight,documentWidth:wc.documentElement.clientWidth,documentHeight:wc.documentElement.clientHeight,bodyWidth:wc.body.clientWidth,bodyHeight:wc.body.clientHeight},disableResending:!0};return this.command.type===d.takeElementScreenshot&&(e.cropDimensions=this._getAbsoluteCropValues()),e},ru.prototype._runScrollBeforeScreenshot=function(){var i=this;return c.Promise.resolve().then(function(){if(i.element||!i.command.selector)return c.Promise.resolve();var t,e,n=i.command.selector.timeout,r="number"==typeof n?n:i.globalSelectorTimeout;return i.statusBar.showWaitingElementStatus(r),t=[{selector:i.command.selector,createNotFoundError:function(t){return new Ve(null,t)},createIsInvisibleError:function(t){return new je(null,t)},createHasWrongNodeTypeError:function(t){return new Ke(t)}}],e=i.globalSelectorTimeout,new Ia(t,e).getElements().then(function(t){i.statusBar.hideWaitingElementStatus(),i.element=t[0]}).catch(function(t){throw i.statusBar.hideWaitingElementStatus(),t})}).then(function(){return function(w,y){return s(this,void 0,void 0,function(){var e,n,r,i,o,s,a,l,u,c,d,h,p,f,m,g,v;return C(this,function(t){if(e=w.getBoundingClientRect(),n={left:e.left,right:e.right,top:e.top,bottom:e.bottom},r=_.styleUtils.getElementMargin(w),i=_.styleUtils.getElementPadding(w),o=_.styleUtils.getBordersWidth(w),y.originOffset={x:0,y:0},s=n.left+w.scrollWidth+o.left+o.right,a=n.top+w.scrollHeight+o.top+o.bottom,n.right=Math.max(n.right,s),n.bottom=Math.max(n.bottom,a),y.includeBorders&&y.includePaddings?y.includeMargins&&(y.originOffset.x-=r.left,y.originOffset.y-=r.top,n.left-=r.left,n.top-=r.top,n.right+=r.right,n.bottom+=r.bottom):(y.originOffset.x+=o.left,y.originOffset.y+=o.top,n.left+=o.left,n.top+=o.top,n.right-=o.right,n.bottom-=o.bottom,y.includePaddings||(y.originOffset.x+=i.left,y.originOffset.y+=i.top,n.left+=i.left,n.top+=i.top,n.right-=i.right,n.bottom-=i.bottom)),n.width=n.right-n.left,n.height=n.bottom-n.top,l=va({min:y.crop.left,max:y.crop.right,length:y.crop.width},n.width),u=va({min:y.crop.top,max:y.crop.bottom,length:y.crop.height},n.height),y.crop.left=l.min,y.crop.right=l.max,y.crop.width=l.length,y.crop.top=u.min,y.crop.bottom=u.max,y.crop.height=u.length,y.crop.width<=0||y.crop.height<=0)throw new Fn(y.crop.width,y.crop.height);if(c=_.styleUtils.getViewportDimensions(),(n.width>c.width||n.height>c.height)&&(y.scrollToCenter=!0),d="number"==typeof y.scrollTargetX,h="number"==typeof y.scrollTargetY,d||(y.scrollTargetX=wa(y.crop.left,y.crop.right,c.width)),h||(y.scrollTargetY=wa(y.crop.top,y.crop.bottom,c.height)),p=E.getOffsetOptions(w,y.scrollTargetX,y.scrollTargetY),f=p.offsetX,m=p.offsetY,y.scrollTargetX=f,y.scrollTargetY=m,g=!d||y.scrollTargetX>=y.crop.left&&y.scrollTargetX<=y.crop.right,v=!h||y.scrollTargetY>=y.crop.top&&y.scrollTargetY<=y.crop.bottom,!g||!v)throw new Dn(g,v);return[2]})})}(i.element,i.command.options)}).then(function(){var t=i.command.options,e=t.scrollTargetX,n=t.scrollTargetY,r=t.scrollToCenter;return new _.ScrollAutomation(i.element,new rl({offsetX:e,offsetY:n,scrollToCenter:r,skipParentFrames:!0})).run()})},ru.prototype._hideUI=function(){return o.hide(),this.command.markData&&o.showScreenshotMark(this.command.markData),_.delay(500)},ru.prototype._showUI=function(){this.command.markData&&o.hideScreenshotMark(),o.show()},ru.prototype._requestManipulation=function(){if(!Ql(vc))return c.transport.queuedAsyncServiceMsg(this._createManipulationReadyMessage());var t=this._getAbsoluteCropValues();return _.sendRequestToFrame({cmd:tu,command:this.command,cropDimensions:t},eu,vc.parent).then(function(t){if(!t.result)return{result:null};var e=t.result,n=e.result,r=e.executionError;if(r)throw r;return{result:n}})},ru.prototype._runManipulation=function(){var r=this,i=null;return c.Promise.resolve().then(function(){return r.command.type!==d.takeElementScreenshot?c.Promise.resolve():(_.scrollController.stopPropagation(),r._runScrollBeforeScreenshot())}).then(function(){return Ql(vc)?c.Promise.resolve():r._hideUI()}).then(function(){return r._requestManipulation()}).then(function(t){var e=t.result,n=t.error;if(n)throw n;return _.scrollController.enablePropagation(),i=e,Ql(vc)||r._showUI(),_.delay(200)}).then(function(){return new hs({isCommandResult:!0,result:i})}).catch(function(t){return _.scrollController.enablePropagation(),new hs({isCommandResult:!0,executionError:t})})},ru.prototype.execute=function(){var t=this;return function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=new _.ClientRequestEmitter,i=new _.RequestBarrier(r),o=new _.ScriptExecutionEmitter,s=new _.ScriptExecutionBarrier(o);_.pageUnloadBarrier.watchForPageNavigationTriggers();var a=null,l=t.apply(void 0,e),u=l.then(function(t){return a=t,c.Promise.all([i.wait().then(function(){return s.wait()}),_.pageUnloadBarrier.wait()])}).then(function(){return a});return{actionPromise:l,barriersPromise:u}}(function(){return t._runManipulation()}).barriersPromise},ru);function ru(t,e,n){this.command=t,this.globalSelectorTimeout=e,this.statusBar=n,this.element=null}function iu(e){return e.getResult().then(function(t){return new hs({isCommandResult:!0,result:e.encodeResult(t)})}).catch(function(t){return new hs({isCommandResult:!0,executionError:t})})}var ou=l.Promise,su=(au.prototype.setAsMaster=function(t){var e=this;return fs(new Eo(t),this.driverWindow,ms,Zn).catch(function(t){if(!e._isNonPageWindow)throw t})},au.prototype.closeAllChildWindows=function(){return fs(new So,this.driverWindow,ms,nr)},au.prototype.findChildWindows=function(t,e){return fs(new e(t),this.driverWindow,ms,Zn)},au.prototype.startToRestore=function(){return fs(new To,this.driverWindow,ms,Zn)},au.prototype.closeFileDownloadingWindow=function(){this._isNonPageWindow=!0,this.driverWindow.close()},au);function au(t,e){this._isNonPageWindow=!1,this.driverWindow=t,this.windowId=e}var lu=(uu.prototype._getTopOpenedWindow=function(t){for(var e=t;e.opener;)e=e.opener;return e.top},uu.prototype._setAsMaster=function(t,e){return fs(new Eo(e),t,ms,Zn)},uu.prototype.getTopOpenedWindow=function(){return this._getTopOpenedWindow(this.currentDriverWindow)},uu.prototype.setTopOpenedWindowAsMaster=function(){var t=this._getTopOpenedWindow(this.currentDriverWindow);return this._setAsMaster(t)},uu.prototype.setParentWindowAsMaster=function(t){void 0===t&&(t={});var e=this.currentDriverWindow.opener;return this._setAsMaster(e,t.finalizePendingCommand)},uu.prototype.restoreChild=function(r){return s(this,void 0,void 0,function(){var e,n;return C(this,function(t){return e=new Ro(r),n=this.currentDriverWindow.opener,fs(e,n,ms,Zn),[2]})})},uu);function uu(t){this.currentDriverWindow=t}var cu="master",du="replica",hu=(pu.prototype.shouldTransform=function(t,e){return e instanceof c.nativeMethods.Node},pu.prototype.toSerializable=function(t){return new Rs(t)},pu.prototype.fromSerializable=function(){},pu);function pu(){this.type="Node"}var fu=(mu.prototype._startListening=function(){var e=this;this._emitter.onRequestSend(function(t){return e._onRequestSend(t)}),this._emitter.onRequestCompleted(function(t){return e._onRequestCompleted(t)}),this._emitter.onRequestError(function(t){return e._onRequestError(t)})},mu.prototype._offListening=function(){this._emitter.offAll()},mu.prototype._onRequestSend=function(t){this._collectingReqs&&this._requests.add(t)},mu.prototype._onRequestCompleted=function(t){var e=this;Bs(this._delays.additionalRequestsCollection).then(function(){return e._onRequestFinished(t)})},mu.prototype._onRequestFinished=function(t){this._requests.has(t)&&(this._requests.delete(t),this._collectingReqs||this._requests.size||!this._watchdog||this._finishWaiting())},mu.prototype._onRequestError=function(t){this._onRequestFinished(t)},mu.prototype._finishWaiting=function(){this._watchdog&&((0,c.nativeMethods.clearTimeout)(this._watchdog),this._watchdog=null),this._requests.clear(),this._offListening(),this._waitResolve()},mu.prototype.wait=function(t){var n=this;return Bs(t?this._delays.pageInitialRequestsCollection:this._delays.requestsCollection).then(function(){return new c.Promise(function(t){var e;n._collectingReqs=!1,n._waitResolve=t,n._requests.size?(e=c.nativeMethods.setTimeout,n._watchdog=e(function(){return n._finishWaiting()},mu.TIMEOUT)):n._finishWaiting()})})},mu.TIMEOUT=3e3,mu);function mu(t,e){var n,r,i;void 0===e&&(e={}),this._delays={requestsCollection:null!==(n=e.requestsCollection)&&void 0!==n?n:50,additionalRequestsCollection:null!==(r=e.additionalRequestsCollection)&&void 0!==r?r:50,pageInitialRequestsCollection:null!==(i=e.pageInitialRequestsCollection)&&void 0!==i?i:50},this._emitter=t,this._waitResolve=null,this._watchdog=null,this._requests=new Set,this._collectingReqs=!0,this._startListening()}var gu=(vu.prototype._startListening=function(){var e=this;this._emitter.onScriptAdded(function(t){return e._onScriptElementAdded(t)}),this._emitter.onScriptLoadedOrFailed(function(t){return e._onScriptLoadedOrFailed(t)})},vu.prototype._offListening=function(){this._emitter.offAll()},vu.prototype._onScriptElementAdded=function(t){var e=this,n=(0,c.nativeMethods.setTimeout)(function(){return e._onScriptLoadedOrFailed(t,!0)},vu.LOADING_TIMEOUT);this._scripts.set(t,n)},vu.prototype._onScriptLoadedOrFailed=function(t,e){var n=this;void 0===e&&(e=!1),this._scripts.has(t)&&(e||(0,c.nativeMethods.clearTimeout)(this._scripts.get(t)),this._scripts.delete(t),this._scripts.size||Bs(25).then(function(){n._waitResolve&&!n._scripts.size&&n._finishWaiting()}))},vu.prototype._finishWaiting=function(){this._watchdog&&((0,c.nativeMethods.clearTimeout)(this._watchdog),this._watchdog=null),this._scripts.clear(),this._offListening(),this._waitResolve(),this._waitResolve=null},vu.prototype.wait=function(){var n=this;return new c.Promise(function(t){var e;n._waitResolve=t,n._scripts.size?(e=c.nativeMethods.setTimeout,n._watchdog=e(function(){return n._finishWaiting()},vu.TIMEOUT)):n._finishWaiting()})},vu.TIMEOUT=3e3,vu.LOADING_TIMEOUT=2e3,vu);function vu(t){this._emitter=t,this._watchdog=null,this._waitResolve=null,this._scripts=new Map,this._startListening()}var wu=(yu.prototype.wait=function(){var t=this;return c.Promise.all([this._requestBarrier.wait().then(function(){return t._scriptExecutionBarrier.wait()}),this._unloadBarrier.wait()]).then()},yu);function yu(t,e,n){this._requestBarrier=new fu(t),this._scriptExecutionBarrier=new gu(e),(this._unloadBarrier=n).watchForPageNavigationTriggers&&n.watchForPageNavigationTriggers()}function _u(t,e){var n=E.calculateSelectTextArguments(e[0],t);return new E.SelectText(e[0],n.startPos,n.endPos,t.options)}function Eu(t){if(!_.domUtils.isFileInput(t))throw new xn}function Cu(i,o){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return p(i)?[4,(e=i,r={stack:(n=o).stack,pageUrl:n.pageUrl,message:n.msg},e.args=[[r]],new ui(e).getResult())]:[3,2];case 1:return[2,t.sent()];case 2:return[2,i||!1]}var e,n,r})})}fa.ACTIONS_HANDLERS[d.dispatchEvent]={additionalSelectorProps:["relatedTarget"],create:function(t,e){return e[1]&&(t.options.relatedTarget=e[1]),new E.DispatchEvent(e[0],t.eventName,t.options)}},fa.ACTIONS_HANDLERS[d.pressKey]={create:function(t){return new E.Press(_.parseKeySequence(t.keys).combinations,t.options)},ensureCmdArgs:function(t){if(_.parseKeySequence(t.keys).error)throw new In("keys")}},fa.ACTIONS_HANDLERS[d.click]={create:function(t,e,n){return/option|optgroup/.test(_.domUtils.getTagName(e[0]))?new E.SelectChildClick(e[0],t.options):(E.cursor.shouldRender=!n,new E.Click(e[0],t.options,vc,E.cursor,n))}},fa.ACTIONS_HANDLERS[d.rightClick]={create:function(t,e){return new E.RClick(e[0],t.options)}},fa.ACTIONS_HANDLERS[d.doubleClick]={create:function(t,e){return new E.DblClick(e[0],t.options)}},fa.ACTIONS_HANDLERS[d.hover]={create:function(t,e){return new E.Hover(e[0],t.options)}},fa.ACTIONS_HANDLERS[d.drag]={create:function(t,e){return new E.DragToOffset(e[0],t.dragOffsetX,t.dragOffsetY,t.options)}},fa.ACTIONS_HANDLERS[d.dragToElement]={additionalSelectorProps:["destinationSelector"],create:function(t,e){return new E.DragToElement(e[0],e[1],t.options)}},fa.ACTIONS_HANDLERS[d.scroll]={create:function(t,e){var n=t.x,r=t.y,i=t.position,o=t.options;return new E.SetScroll(e[0],{x:n,y:r,position:i},o)}},fa.ACTIONS_HANDLERS[d.scrollBy]={create:function(t,e){var n=t.byX,r=t.byY,i=t.options;return new E.SetScroll(e[0],{byX:n,byY:r},i)}},fa.ACTIONS_HANDLERS[d.scrollIntoView]={create:function(t,e){return new E.ScrollIntoView(e[0],t.options)}},fa.ACTIONS_HANDLERS[d.typeText]={create:function(t,e){return new E.Type(e[0],t.text,t.options)}},fa.ACTIONS_HANDLERS[d.selectText]={create:_u,ensureElsProps:function(t){if(!_.domUtils.isEditableElement(t[0]))throw new dn}},fa.ACTIONS_HANDLERS[d.selectTextAreaContent]={create:_u,ensureElsProps:function(t){if(!_.domUtils.isTextAreaElement(t[0]))throw new fn}},fa.ACTIONS_HANDLERS[d.selectEditableContent]={additionalSelectorProps:["startSelector","endSelector"],create:function(t,e){return t.endSelector=t.endSelector||t.startSelector,new E.SelectEditableContent(e[0],e[1],t.options)},ensureElsProps:function(t){if(!_.domUtils.isContentEditableElement(t[0]))throw new vn("startSelector");if(!_.domUtils.isContentEditableElement(t[1]))throw new vn("endSelector");if(!_.contentEditable.getNearestCommonAncestor(t[0],t[1]))throw new _n}},fa.ACTIONS_HANDLERS[d.setFilesToUpload]={create:function(t,e){return new E.Upload(e[0],t.filePath,function(t,e){return new Wn(t,e)})},ensureElsProps:function(t){return Eu(t[0])}},fa.ACTIONS_HANDLERS[d.clearUpload]={create:function(t,e){return new E.Upload(e[0])},ensureElsProps:function(t){return Eu(t[0])}};var Iu,Su=l.settings,bu=l.transport,Wu=l.Promise,Tu=l.eventSandbox.message,Au=l.storages,xu=l.nativeMethods,Ru=xu.date,Nu=l.eventSandbox.listeners,Du=l.utils.url,Pu="testcafe|driver|test-done-sent-flag",Mu="testcafe|driver|pending-status",Fu="testcafe|driver|executing-client-function-descriptor",ku="testcafe|driver|executing-skip-js-errors-function-flag",Ou="testcafe|driver|selector-execution-start-time",Lu="testcafe|driver|pending-page-error",Uu="testcafe|driver|active-iframe-selector",Hu="testcafe|driver|test-speed",Bu="testcafe|driver|assertion-retries-timeout",Gu="testcafe|driver|assertion-retries-start-time",Vu="testcafe|driver|console-messages",qu="testcafe|driver|pending-child-window-count",zu={NotLoadedError:Bn,NotFoundError:Ve,IsInvisibleError:je},ju={NotLoadedError:qn,NotFoundError:xr,IsInvisibleError:Dr},Xu=Math.pow(2,31)-1,Yu="status-with-command-result-event",Ku="empty-command-event",Ju="child-window-closed",$u="skip-js-errors-function-execution-complete",Qu=(t(Zu,Iu=_.serviceUtils.EventEmitter),Zu.prototype._isOpenedInIframe=function(){var t=vc.opener;return t&&t.top&&t.top!==t},Object.defineProperty(Zu.prototype,"speed",{get:function(){return this.contextStorage.getItem(Hu)},set:function(t){this.contextStorage.setItem(Hu,t)},enumerable:!1,configurable:!0}),Object.defineProperty(Zu.prototype,"consoleMessages",{get:function(){return new zr(this.contextStorage.getItem(Vu))},set:function(t){return this.contextStorage.setItem(Vu,t?t.getCopy():null)},enumerable:!1,configurable:!0}),Zu.prototype._getReadyPromise=function(){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return[4,_.eventUtils.documentReady(this.options.pageLoadTimeout)];case 1:return t.sent(),[4,this.pageInitialRequestBarrier.wait(!0)];case 2:return t.sent(),[2]}})})},Zu.prototype._hasPendingActionFlags=function(t){return t.getItem(this.COMMAND_EXECUTING_FLAG)||t.getItem(this.EXECUTING_IN_IFRAME_FLAG)},Zu.prototype._getCurrentWindowId=function(){if(this.options.proxyless)return this.runInfo.activeWindowId;var t=vc.location.toString(),e=l.utils.url.parseProxyUrl(t);return e&&e.windowId||null},Zu.prototype._onJsError=function(n){return s(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:if(this.contextStorage.getItem(Pu))return[2];if(!this.options.skipJsErrors)return[3,6];this.contextStorage.setItem(ku,!0),t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,Cu(this.options.skipJsErrors,n)];case 2:return t.sent()||this._setUncaughtErrorOnPage(n),[3,5];case 3:return e=t.sent(),this.contextStorage.getItem(Lu)||this.contextStorage.setItem(Lu,e),[3,5];case 4:return this.contextStorage.setItem(ku,!1),this.emit($u),[7];case 5:return[2];case 6:return this._setUncaughtErrorOnPage(n),[2]}})})},Zu.prototype._setUncaughtErrorOnPage=function(t){var e=new Vt(t.stack,t.pageUrl);this.contextStorage.getItem(Lu)||this.contextStorage.setItem(Lu,e)},Zu.prototype._unlockPageAfterTestIsDone=function(){return this.options.proxyless||_.disableRealEventsPreventing(),Wu.resolve()},Zu.prototype._getActiveElement=function(){return s(this,void 0,void 0,function(){var e;return C(this,function(t){return e=_.domUtils.getActiveElement(),[2,this.replicator.encode(e)]})})},Zu.prototype._failIfClientCodeExecutionIsInterrupted=function(){var t=this.contextStorage.getItem(Fu);return!!t&&(this._onReady(new hs({isCommandResult:!0,executionError:new At(t.instantiationCallsiteName)})),!0)},Zu.prototype.onCustomClientScriptError=function(t,e){var n=e?new ee(t,e):new Qt(t);this.contextStorage.getItem(Lu)||this.contextStorage.setItem(Lu,n)},Zu.prototype._addChildWindowDriverLink=function(t){var e=new su(t.window,t.windowId);this.childWindowDriverLinks.push(e),this._ensureClosedChildWindowWatcher()},Zu.prototype._ensureClosedChildWindowWatcher=function(){var e=this;this.checkClosedChildWindowIntervalId||(this.checkClosedChildWindowIntervalId=xu.setInterval.call(vc,function(){var t=_.arrayUtils.find(e.childWindowDriverLinks,function(t){return t.driverWindow.closed});t&&(e.emit(Ju),_.arrayUtils.remove(e.childWindowDriverLinks,t),t.ignoreMasterSwitching||e._setCurrentWindowAsMaster(),e.childWindowDriverLinks.length||(xu.clearInterval.call(vc,e.checkClosedChildWindowIntervalId),delete e.checkClosedChildWindowIntervalId))},200))},Zu.prototype._setAsMasterInProgressOrCompleted=function(){return this.setAsMasterInProgress||this.role===cu},Zu.prototype._setCurrentWindowAsMaster=function(){var t=this;this._setAsMasterInProgressOrCompleted()||(this.setAsMasterInProgress=!0,this._clearActiveChildIframeInfo(),Wu.resolve().then(function(){return _.browser.setActiveWindowId(t.communicationUrls.activeWindowId,l.createNativeXHR,t.windowId)}).then(function(){t._startInternal({finalizePendingCommand:!0,isFirstRequestAfterWindowSwitching:!0}),t.setAsMasterInProgress=!1}).catch(function(){t._onReady(new hs({isCommandResult:!0,executionError:new Zn}))}))},Zu.prototype._onChildWindowOpened=function(t){this._addChildWindowDriverLink(t),this._switchToChildWindow(t.windowId)},Zu.prototype._sendStartToRestoreCommand=function(){if(this.contextStorage){this._stopRespondToChildren=!0,this.contextStorage.setItem(qu,this.childWindowDriverLinks.length);for(var t=0,e=this.childWindowDriverLinks;t<e.length;t++)e[t].startToRestore()}},Zu.prototype._onFormSubmit=function(t){this.contextStorage&&this.contextStorage.getItem(Pu)&&(t.preventSubmit=!0)},Zu.prototype._onConsoleMessage=function(t){var e=t.meth,n=t.line,r=this.consoleMessages;r.addMessage(e,n,this.windowId),this.consoleMessages=r},Zu.prototype._addPendingErrorToStatus=function(t){var e=this.contextStorage.getItem(Lu);e&&(this.contextStorage.setItem(Lu,null),t.pageError=e)},Zu.prototype._addUnexpectedDialogErrorToStatus=function(t){var e=this.nativeDialogsTracker.getUnexpectedDialogError();t.pageError=t.pageError||e},Zu.prototype._addConsoleMessagesToStatus=function(t){t.consoleMessages=this.consoleMessages,this.consoleMessages=null},Zu.prototype._addPendingWindowSwitchingStateToStatus=function(t){t.isPendingWindowSwitching=this._isPendingSwitchingWindow()},Zu.prototype._sendStatusRequest=function(t){function e(){return _.getTimeLimitedPromise(bu.asyncServiceMsg(r),5e3)}function n(){return _.delay(300).then(e)}for(var r={cmd:u.ready,status:t,disableResending:!0,allowRejecting:!0},i=e(),o=0;o<a;o++)i=i.catch(n);return i},Zu.prototype._sendStatus=function(t){var e=this;t.resent||(this._addPendingErrorToStatus(t),this._addUnexpectedDialogErrorToStatus(t),this._addConsoleMessagesToStatus(t),this._addPendingWindowSwitchingStateToStatus(t)),this.contextStorage.setItem(Mu,t);var n=null;return _.pageUnloadBarrier.wait(0).then(function(){return e._sendStatusRequest(t)}).then(function(t){return n=t,_.pageUnloadBarrier.wait(0)}).then(function(){return e.contextStorage.setItem(Mu,null),n})},Zu.prototype._addChildIframeDriverLink=function(t,e){var n,r=this._getChildIframeDriverLinkByWindow(e);r||(n="".concat(this.testRunId,"-").concat(Ii()),r=new vs(e,n,this.communicationUrls.dispatchProxylessEvent),this.childIframeDriverLinks.push(r)),r.sendConfirmationMessage(t)},Zu.prototype._getTargetWindowNotFoundResult=function(t,e){return Wu.resolve({success:!1,errCode:t,errMsg:e})},Zu.prototype._getChildWindowValidateResult=function(t){var e=t.find(function(t){return t.result.success});if(e)return e.result;var n=t.find(function(t){return t.result.errCode===_.TEST_RUN_ERRORS.cannotCloseWindowWithChildrenError||t.result.errCode===_.TEST_RUN_ERRORS.cannotCloseWindowWithoutParent});return(n=n||t.find(function(t){return!!t.result.errCode}))?{errCode:n.result.errCode}:void 0},Zu.prototype._handleWindowValidation=function(n,r,i,o){return s(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return[4,this._validateWindow(n,r,i,o)];case 1:return e=t.sent(),gs({requestMsgId:n.id,window:r,result:e}),[2]}})})},Zu.prototype._getWindowInfo=function(){var t=l.utils.url.parseProxyUrl(vc.location.toString());return{id:this.windowId,title:wc.title,url:t.destUrl}},Zu.prototype._isTargetWindow=function(t){return t.windowId===this.windowId},Zu.prototype._validateWindow=function(r,t,i,o){return s(this,void 0,void 0,function(){var e,n;return C(this,function(t){switch(t.label){case 0:return this._isTargetWindow(r)?[2,i()]:this.childWindowDriverLinks.length?(e=this.childWindowDriverLinks.map(function(t){return t.findChildWindows(r,o)}),[4,Wu.all(e)]):[2,this._getTargetWindowNotFoundResult(_.TEST_RUN_ERRORS.targetWindowNotFoundError)];case 1:return n=t.sent(),[2,this._getChildWindowValidateResult(n)]}})})},Zu._createWindowValidationError=function(t){var e=t.errCode;return new(e===_.TEST_RUN_ERRORS.cannotCloseWindowWithChildrenError?or:e===_.TEST_RUN_ERRORS.cannotCloseWindowWithoutParent?lr:fr)},Zu.prototype._getCloseWindowFoundResult=function(){return this.parentWindowDriverLink?this.childWindowDriverLinks.length?Wu.resolve({success:!1,errCode:_.TEST_RUN_ERRORS.cannotCloseWindowWithChildrenError}):Wu.resolve({success:!0}):Wu.resolve({success:!1,errCode:_.TEST_RUN_ERRORS.cannotCloseWindowWithoutParent})},Zu.prototype._handleCloseWindowValidation=function(t,e){var n=this;return this._handleWindowValidation(t,e,function(){return n._getCloseWindowFoundResult()},Xi)},Zu.prototype._handleSwitchToWindowValidation=function(t,e){return this._handleWindowValidation(t,e,function(){return Wu.resolve({success:!0})},Ji)},Zu.prototype._handleCloseWindow=function(e,n){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return[4,this._closeWindow(e,n)];case 1:return t.sent(),gs({requestMsgId:e.id,window:n}),[2]}})})},Zu.prototype._closeWindowAndWait=function(n,r){return s(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return e=this._createWaitForEventPromise(Ju,2e3),n.ignoreMasterSwitching=!r.isCurrentWindow,this.closing?[3,2]:(this.closing=!0,[4,_.browser.closeWindow(this.communicationUrls.closeWindow,l.createNativeXHR,this.windowId)]);case 1:t.sent(),t.label=2;case 2:return n.driverWindow.close(),[2,e]}})})},Zu.prototype._closeWindow=function(e){if(!this.childWindowDriverLinks.length)return Wu.resolve();var t=this.childWindowDriverLinks.find(function(t){return t.windowId===e.windowId});if(t)return this._closeWindowAndWait(t,e);var n=this.childWindowDriverLinks.map(function(t){return t.findChildWindows(e,no)});return Wu.all(n)},Zu.prototype._getWindows=function(){return s(this,void 0,void 0,function(){var e,n,r,i,o,s;return C(this,function(t){switch(t.label){case 0:return this.childWindowDriverLinks.length?(e=this.childWindowDriverLinks.map(function(t){return t.findChildWindows({},Zi)}),[4,Wu.all(e)]):[2,[this._getWindowInfo()]];case 1:for(n=t.sent(),r=[this._getWindowInfo()],i=0,o=n;i<o.length;i++)s=o[i],Array.isArray(s.result)&&(r=r.concat(s.result));return[2,r]}})})},Zu.prototype._handleGetWindows=function(n,r){return s(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return[4,this._getWindows(n,r)];case 1:return e=t.sent(),gs({requestMsgId:n.id,window:r,result:e}),[2]}})})},Zu.prototype._handleSwitchToWindow=function(e,n){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return[4,this._switchToWindow(e)];case 1:return t.sent(),gs({requestMsgId:e.id,window:n}),[2]}})})},Zu.prototype._switchToWindow=function(e){var t=this;return this._isTargetWindow(e)?Wu.resolve().then(function(){t._setCurrentWindowAsMaster()}):this.childWindowDriverLinks.length?Wu.all(this.childWindowDriverLinks.map(function(t){return t.findChildWindows(e,oo)})):Wu.resolve()},Zu.prototype._handleSetAsMasterMessage=function(t,e){var n=this;this._setAsMasterInProgressOrCompleted()||(this.setAsMasterInProgress=!0,gs({requestMsgId:t.id,window:e}),Wu.resolve().then(function(){return _.browser.setActiveWindowId(n.communicationUrls.activeWindowId,l.createNativeXHR,n.windowId)}).then(function(){n._startInternal({finalizePendingCommand:t.finalizePendingCommand,result:{id:n.windowId}}),n.setAsMasterInProgress=!1}).catch(function(){n._onReady(new hs({isCommandResult:!0,executionError:new Zn}))}))},Zu.prototype._handleCloseAllWindowsMessage=function(t,e){var n=this;this._closeAllChildWindows().then(function(){gs({requestMsgId:t.id,window:e})}).catch(function(){n._onReady(new hs({isCommandResult:!0,executionError:new nr}))})},Zu.prototype._handleStartToRestoreChildLinkMessage=function(){this.parentWindowDriverLink.restoreChild(this._getCurrentWindowId())},Zu.prototype._handleHasPendingActionFlags=function(t,e){var n=this._hasPendingActionFlags(this.contextStorage);gs({requestMsgId:t.id,window:e,result:n})},Zu.prototype._handleRestoreChildLink=function(t,e){this._stopRespondToChildren||(this._addChildWindowDriverLink({window:e,windowId:t.windowId}),this.childWindowDriverLinks.length===this.contextStorage.getItem(qu)&&this._restoreChildWindowsPromiseResolver&&(this._restoreChildWindowsPromiseResolver(),delete this._restoreChildWindowsPromiseResolver,this.contextStorage.setItem(qu,0)),gs({requestMsgId:t.id,window:e}))},Zu.prototype._handleChildWindowIsOpenedInIFrame=function(){var e=this;this._pendingChildWindowInIFrame=new Wu(function(t){e._resolvePendingChildWindowInIframe=t})},Zu.prototype._handleChildWindowIsLoadedInIFrame=function(e,t){gs({requestMsgId:e.id,window:t}),this._resolvePendingChildWindowInIframe(),this.childWindowDriverLinks.find(function(t){return t.windowId===e.windowId})||this._onChildWindowOpened({window:t,windowId:e.windowId})},Zu.prototype._handleStopInternalFromFrame=function(t,e){gs({requestMsgId:t.id,window:e}),this.contextStorage.setItem(this.EXECUTING_IN_IFRAME_FLAG,!1),this._stopInternal()},Zu.prototype._initChildDriverListening=function(){var r=this;Tu.on(Tu.SERVICE_MSG_RECEIVED_EVENT,function(t){var e=t.message,n=t.source;switch(e.type){case Wi:r._addChildIframeDriverLink(e.id,n);break;case Bi:r._handleChildWindowIsOpenedInIFrame(e,n);break;case Hi:r._handleChildWindowIsLoadedInIFrame(e,n);break;case Gi:r._handleStopInternalFromFrame(e,n);break;case ki:r._handleSetAsMasterMessage(e,n);break;case Ti:r._handleSwitchToWindow(e,n);break;case Ai:r._handleCloseWindow(e,n);break;case Ri:r._handleSwitchToWindowValidation(e,n);break;case xi:r._handleCloseWindowValidation(e,n);break;case Ni:r._handleGetWindows(e,n);break;case Oi:r._handleCloseAllWindowsMessage(e,n);break;case Li:r._handleStartToRestoreChildLinkMessage();break;case Vi:r._handleHasPendingActionFlags(e,n);break;case Ui:r._handleRestoreChildLink(e,n)}})},Zu.prototype._getChildIframeDriverLinkByWindow=function(e){return _.arrayUtils.find(this.childIframeDriverLinks,function(t){return t.driverWindow===e})},Zu.prototype._getChildWindowDriverLinkByWindow=function(e){return _.arrayUtils.find(this.childWindowDriverLinks,function(t){return t.driverWindow===e})},Zu.prototype._runInActiveIframe=function(t){var e=this,n=Wu.resolve(),r=this.contextStorage.getItem(Uu);!this.activeChildIframeDriverLink&&r&&(n=this._switchToIframe(r,ju)),n.then(function(){return e.contextStorage.setItem(e.EXECUTING_IN_IFRAME_FLAG,!0),e.activeChildIframeDriverLink.executeCommand(t,e.speed)}).then(function(t){return e._onCommandExecutedInIframe(t)}).catch(function(t){return e._onCommandExecutedInIframe(new hs({isCommandResult:!0,executionError:t}))})},Zu.prototype._onCommandExecutedInIframe=function(t){var e=this;this.contextStorage.setItem(this.EXECUTING_IN_IFRAME_FLAG,!1);var n=Wu.resolve();this._pendingChildWindowInIFrame&&(n=this._pendingChildWindowInIFrame),n.then(function(){e._onReady(t)})},Zu.prototype._ensureChildIframeDriverLink=function(t,e,n){var r=this;return _.waitFor(function(){return r._getChildIframeDriverLinkByWindow(t)},500,n).catch(function(){throw new e})},Zu.prototype._ensureChildWindowDriverLink=function(t,e,n){var r=this;return _.waitFor(function(){return r._getChildWindowDriverLinkByWindow(t)},500,n).catch(function(){throw new e})},Zu.prototype._switchToIframe=function(e,n){var t,r,i,o,s,a,l,u=this,c="number"==typeof e.timeout,d=c?e.timeout:this.options.selectorTimeout;return t=e,r=d,i=null,o=function(t){return new n.NotFoundError(null,t)},s=function(){return new n.IsInvisibleError},a=this.statusBar,l=new _a(t,r,i,o,s),a.showWaitingElementStatus(l.timeout),l.getResult().then(function(t){return a.hideWaitingElementStatus(!!t).then(function(){return t})}).catch(function(t){return a.hideWaitingElementStatus(!1).then(function(){throw t})}).then(function(t){if(!_.domUtils.isIframeElement(t))throw new Ln;var e=c?d:Math.max(d,5e3);return u._ensureChildIframeDriverLink(xu.contentWindowGetter.call(t),n.NotLoadedError,e)}).then(function(t){t.availabilityTimeout=d,u.activeChildIframeDriverLink=t,u.contextStorage.setItem(Uu,e)})},Zu.prototype._createWaitForEventPromise=function(e,n){var r=this,i=null,t=new Wu(function(t){xu.setTimeout.call(vc,function(){r.off(e,i),t()},n)}),o=new Wu(function(t){i=function(){this.off(e,i),t()},r.on(e,i)});return Wu.race([t,o])},Zu.prototype._waitForCurrentCommandCompletion=function(){return this.contextStorage.getItem(this.COMMAND_EXECUTING_FLAG)?this._createWaitForEventPromise(Yu,Xu):Wu.resolve()},Zu.prototype._waitForSkipJsErrorFunctionCompletion=function(n){var r=this;return this.contextStorage.getItem(ku)?new Wu(function(t){var e=function(){r.off($u,e),t(n)};r.on($u,e)}):Wu.resolve(n)},Zu.prototype._waitForEmptyCommand=function(){return this._createWaitForEventPromise(Ku,3e4)},Zu.prototype._abortSwitchingToChildWindowIfItClosed=function(){if(this.activeChildWindowDriverLink.driverWindow.closed)throw _.arrayUtils.remove(this.childWindowDriverLinks,this.activeChildWindowDriverLink),this.activeChildWindowDriverLink=null,new Ir},Zu.prototype._switchToChildWindow=function(t){var e=this;this.contextStorage.setItem(this.PENDING_WINDOW_SWITCHING_FLAG,!0);var n=this.contextStorage.getItem(this.WINDOW_COMMAND_API_CALL_FLAG);return function(e,t){if("string"!=typeof e)return ou.resolve(null);var n=_.arrayUtils.find(t,function(t){return t.windowId===e});if(n)return ou.resolve(n);var r=new Xn;return ou.reject(r)}(t,this.childWindowDriverLinks).then(function(t){return e._ensureChildWindowDriverLink(t.driverWindow,Jn,e.options.childWindowReadyTimeout)}).then(function(t){return e.activeChildWindowDriverLink=t,e._waitForCurrentCommandCompletion()}).then(function(){return n?void 0:e._waitForEmptyCommand()}).then(function(){return e._observeFileDownloadingInNewWindow(),e._abortSwitchingToChildWindowIfItClosed(),e._stopInternal(),e.activeChildWindowDriverLink.setAsMaster(n)}).then(function(){e.contextStorage.setItem(e.PENDING_WINDOW_SWITCHING_FLAG,!1)}).catch(function(t){e.contextStorage.setItem(e.PENDING_WINDOW_SWITCHING_FLAG,!1),t instanceof Ir?e._onReady(new hs):e._onReady(new hs({isCommandResult:!0,executionError:new Zn}))})},Zu.prototype._switchToTopParentWindow=function(){var t=this.parentWindowDriverLink.setTopOpenedWindowAsMaster.bind(this.parentWindowDriverLink);this._switchToParentWindowInternal(t)},Zu.prototype._switchToParentWindow=function(t){void 0===t&&(t={});var e=this.parentWindowDriverLink.setParentWindowAsMaster.bind(this.parentWindowDriverLink);this._switchToParentWindowInternal(e,t)},Zu.prototype._switchToParentWindowInternal=function(t,e){var n=this;return void 0===e&&(e={}),this.contextStorage.setItem(this.PENDING_WINDOW_SWITCHING_FLAG,!0),Wu.resolve().then(function(){return n._stopInternal(),t(e)}).then(function(){n.contextStorage.setItem(n.PENDING_WINDOW_SWITCHING_FLAG,!1)}).catch(function(){n.contextStorage.setItem(n.PENDING_WINDOW_SWITCHING_FLAG,!1),n._onReady(new hs({isCommandResult:!0,executionError:new Zn}))})},Zu.prototype._switchToMainWindow=function(t){this.activeChildIframeDriverLink&&this.activeChildIframeDriverLink.executeCommand(t),this._clearActiveChildIframeInfo()},Zu.prototype._clearActiveChildIframeInfo=function(){this.contextStorage.setItem(Uu,null),this.activeChildIframeDriverLink=null},Zu.prototype._setNativeDialogHandlerInIframes=function(t){for(var e=new wo(t),n=0;n<this.childIframeDriverLinks.length;n++)Tu.sendServiceMsg(e,this.childIframeDriverLinks[n].driverWindow)},Zu.prototype._onActionCommand=function(t){var o=this,e=this.options.proxyless?_.browser.dispatchProxylessEvent.bind(_.browser.dispatchProxylessEvent,this.communicationUrls.dispatchProxylessEvent,l.createNativeXHR):null,n=new fa(t,{globalSelectorTimeout:this.options.selectorTimeout,testSpeed:this.speed,executeSelectorFn:function(t,e,n){var r=zs(e.notFound),i=zs(e.invisible);return new _a(t,o.options.selectorTimeout,n,r,i).getResult()},dispatchProxylessEventFn:e}),r=[];n.on(fa.EXECUTION_STARTED_EVENT,function(){o.statusBar.hideWaitingElementStatus(!0),o.contextStorage.setItem(o.COMMAND_EXECUTING_FLAG,!0)}),n.on(fa.WAITING_FOR_ELEMENT_EVENT,function(t){o.statusBar.showWaitingElementStatus(t)}),n.on(fa.WARNING_EVENT,function(t){r.push(t)});var i=new _.ClientRequestEmitter,s=new _.ScriptExecutionEmitter,a=new wu(i,s,_.pageUnloadBarrier);n.execute(a).then(function(t){return new hs({isCommandResult:!0,result:$r(new hu).encode(t),warnings:r})}).catch(function(t){return o.statusBar.hideWaitingElementStatus(!1).then(function(){return new hs({isCommandResult:!0,executionError:t})})}).then(function(t){return o._waitForSkipJsErrorFunctionCompletion(t)}).then(function(t){o.contextStorage.setItem(o.COMMAND_EXECUTING_FLAG,!1),o.contextStorage.setItem(ku,!1),o._onReady(t)})},Zu.prototype._onSetNativeDialogHandlerCommand=function(t){this.nativeDialogsTracker.setHandler(t.dialogHandler),this._setNativeDialogHandlerInIframes(t.dialogHandler),this._onReady(new hs({isCommandResult:!0}))},Zu.prototype._onGetNativeDialogHistoryCommand=function(){this._onReady(new hs({isCommandResult:!0,result:this.nativeDialogsTracker.appearedDialogs}))},Zu.prototype._onGetBrowserConsoleMessagesCommand=function(){this._onReady(new hs({isCommandResult:!0}))},Zu.prototype._onNavigateToCommand=function(t){var e=this;this.contextStorage.setItem(this.COMMAND_EXECUTING_FLAG,!0),function(i){return s(this,void 0,void 0,function(){var e,n,r;return C(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=new _.ClientRequestEmitter,n=new _.RequestBarrier(e),c.navigateTo(i.url,i.forceReload),[4,c.Promise.all([n.wait(),_.pageUnloadBarrier.wait()])];case 1:return t.sent(),[2,new hs({isCommandResult:!0})];case 2:return r=t.sent(),[2,new hs({isCommandResult:!0,executionError:r})];case 3:return[2]}})})}(t).then(function(t){return e.contextStorage.setItem(e.COMMAND_EXECUTING_FLAG,!1),e._onReady(t)})},Zu.prototype._onGetProxyUrlCommand=function(t){this._onReady(new hs({isCommandResult:!0,result:Du.getProxyUrl(t.url,t.options)}))},Zu.prototype._onSkipJsErrorsCommand=function(t){var e=t.options;this.options.skipJsErrors=e,this._onReady(new hs({isCommandResult:!0}))},Zu.prototype._onExecuteClientFunctionCommand=function(t){var e=this;this.contextStorage.setItem(Fu,{instantiationCallsiteName:t.instantiationCallsiteName}),iu(new ui(t)).then(function(t){e.contextStorage.setItem(Fu,null),e._onReady(t)})},Zu.prototype._onExecuteSelectorCommand=function(t){var e,n,r,i,o,s,a,l=this,u=this.contextStorage.getItem(Ou)||new Ru,c=zs("CannotObtainInfoForElementSpecifiedBySelectorError"),d=t.strictError?zs(qs()):c,h=t.strictError?zs(Vs()):c;e=t,n=this.options.selectorTimeout,r=u,i=t.needError?d:null,o=t.needError?h:null,s=this.statusBar,a=new _a(e,n,r,i,o),s.showWaitingElementStatus(a.timeout),iu(a).then(function(t){return s.hideWaitingElementStatus(!!t.result).then(function(){return t})}).then(function(t){l.contextStorage.setItem(Ou,null),l._onReady(t)})},Zu.prototype._onSwitchToMainWindowCommand=function(t){this._switchToMainWindow(t),this._onReady(new hs({isCommandResult:!0}))},Zu.prototype._onSwitchToIframeCommand=function(t){var e=this;this._switchToIframe(t.selector,zu).then(function(){return e._onReady(new hs({isCommandResult:!0}))}).catch(function(t){return e._onReady(new hs({isCommandResult:!0,executionError:t}))})},Zu.prototype._onWindowOpenCommand=function(t){this.contextStorage.setItem(this.WINDOW_COMMAND_API_CALL_FLAG,!0),vc.open(t.url)},Zu.prototype._onWindowCloseCommand=function(a){return s(this,void 0,void 0,function(){var e,n,r,i,o,s;return C(this,function(t){switch(t.label){case 0:e=this._getTopOpenedWindow(),n=a.windowId||this.windowId,r=n===this.windowId,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,this._validateChildWindowCloseCommandExists(n,e)];case 2:if(i=t.sent(),!(o=i.result).success)throw Zu._createWindowValidationError(o);return[4,fs(new no({windowId:n,isCurrentWindow:r}),e,ms,Zn)];case 3:return t.sent(),r||this._onReady(new hs({isCommandResult:!0})),[3,5];case 4:return s=t.sent(),this._onReady(new hs({isCommandResult:!0,executionError:s})),[3,5];case 5:return[2]}})})},Zu.prototype._onGetCurrentWindowCommand=function(){this._onReady(new hs({isCommandResult:!0,result:{id:this.windowId}}))},Zu.prototype._onGetWindowsCommand=function(){return s(this,void 0,void 0,function(){var e,n;return C(this,function(t){switch(t.label){case 0:return e=this._getTopOpenedWindow(),[4,fs(new Zi,e,ms,Zn)];case 1:return n=t.sent(),this._onReady(new hs({isCommandResult:!0,result:n.result})),[2]}})})},Zu.prototype._validateChildWindowCloseCommandExists=function(t,e){return fs(new Xi({windowId:t}),e,ms,Zn)},Zu.prototype._validateChildWindowSwitchToWindowCommandExists=function(t,e){var n=t.windowId,r=t.fn;return fs(new Ji({windowId:n,fn:r}),e,ms,Zn)},Zu.prototype._getTopOpenedWindow=function(){var t;return((null===(t=this.parentWindowDriverLink)||void 0===t?void 0:t.getTopOpenedWindow())||vc).top},Zu.prototype._onSwitchToWindow=function(i,o){return s(this,void 0,void 0,function(){var e,n,r;return C(this,function(t){switch(t.label){case 0:return e=this._getTopOpenedWindow(),[4,this._validateChildWindowSwitchToWindowCommandExists({windowId:i.windowId,fn:i.checkWindow},e)];case 1:return n=t.sent(),(r=n.result).success?(this._stopInternal(),fs(new oo({windowId:i.windowId,fn:i.checkWindow}),e,ms,Zn)):this._onReady(new hs({isCommandResult:!0,executionError:o||Zu._createWindowValidationError(r)})),[2]}})})},Zu.prototype._restoreChildWindowLinks=function(){return s(this,void 0,void 0,function(){var e,n=this;return C(this,function(t){switch(t.label){case 0:if(!this.contextStorage.getItem(qu))return[2];e=new Wu(function(t){n._restoreChildWindowsPromiseResolver=t}),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,_.getTimeLimitedPromise(e,3e4)];case 2:return t.sent(),[3,4];case 3:return t.sent(),this._onReady(new hs({isCommandResult:!0,executionError:new Wr})),[3,4];case 4:return[2]}})})},Zu.prototype._onSwitchToPreviousWindow=function(t){this._onSwitchToWindow(t,new _r)},Zu.prototype._onSwitchToParentWindow=function(){this.parentWindowDriverLink?this._switchToParentWindow({finalizePendingCommand:!0}):this._onReady(new hs({isCommandResult:!0,executionError:new vr}))},Zu.prototype._onBrowserManipulationCommand=function(t){var e,n,r,i=this;this.contextStorage.setItem(this.COMMAND_EXECUTING_FLAG,!0),e=t,n=this.options.selectorTimeout,r=this.statusBar,new nu(e,n,r).execute().then(function(t){return i.contextStorage.setItem(i.COMMAND_EXECUTING_FLAG,!1),i._onReady(t)})},Zu.prototype._onSetBreakpointCommand=function(t){var n=this,e=t.isTestError,r=t.inCompilerService,i=this.statusBar.showDebuggingStatus(e);r?(i.then(function(t){n.debug=t}),this._onReady(new hs({isCommandResult:!0,result:!0}))):i.then(function(t){var e=t===w;n._onReady(new hs({isCommandResult:!0,result:e}))})},Zu.prototype._onDisableDebugCommand=function(){this.statusBar._resetState(),this._onReady(new hs({isCommandResult:!0}))},Zu.prototype._onSetTestSpeedCommand=function(t){this.speed=t.speed,this._onReady(new hs({isCommandResult:!0}))},Zu.prototype._onShowAssertionRetriesStatusCommand=function(t){this.contextStorage.setItem(Bu,t.timeout),this.contextStorage.setItem(Gu,xu.dateNow()),this.statusBar.showWaitingAssertionRetriesStatus(t.timeout),this._onReady(new hs({isCommandResult:!0}))},Zu.prototype._onHideAssertionRetriesStatusCommand=function(t){var e=this;this.contextStorage.setItem(Bu,null),this.contextStorage.setItem(Gu,null),this.statusBar.hideWaitingAssertionRetriesStatus(t.success).then(function(){return e._onReady(new hs({isCommandResult:!0}))})},Zu.prototype._checkStatus=function(){var n=this,t={statusUrl:this.communicationUrls.statusDone};return _.browser.checkStatus(t,l.createNativeXHR,{manualRedirect:!0,proxyless:this.options.proxyless}).then(function(t){var e=t.command;e.testRunId!==n.testRunId?(Au.clear(),Au.lock(),_.browser.redirect(e,l.createNativeXHR,n.communicationUrls.openFileProtocolUrl)):(n.contextStorage.setItem(Pu,!1),n._onReady({isCommandResult:!1}))}).catch(function(){return _.delay(1e3)})},Zu.prototype._onCustomCommand=function(t){var e=this;(0,this.customCommandHandlers[t.type].handler)(t).then(function(t){e._onReady(new hs({isCommandResult:!0,result:t}))})},Zu.prototype._closeAllChildWindows=function(){var t=this;return this.childWindowDriverLinks.length?Wu.all(this.childWindowDriverLinks.map(function(t){return t.closeAllChildWindows()})).then(function(){xu.arrayForEach.call(t.childWindowDriverLinks,function(t){t.driverWindow.close()})}):Wu.resolve()},Zu.prototype._onTestDone=function(t){var e=this;this.contextStorage.setItem(Pu,!0),this.parentWindowDriverLink?this._switchToTopParentWindow():this._closeAllChildWindows().then(function(){return e._sendStatus(t)}).then(function(){e._checkStatus()}).catch(function(){e._onReady(new hs({isCommandResult:!0,executionError:nr}))})},Zu.prototype._onBackupStoragesCommand=function(){this._onReady(new hs({isCommandResult:!0,result:Au.backup()}))},Zu.prototype._isPendingSwitchingWindow=function(){return!!this.contextStorage.getItem(this.PENDING_WINDOW_SWITCHING_FLAG)},Zu.prototype._onPrepareClientEnvironmentInDebugMode=function(t){xu.objectDefineProperty(vc,t.esmRuntime,{value:{g:vc,c:vc.eval},configurable:!0}),this._onReady(new hs({isCommandResult:!0,result:!0}))},Zu.prototype._isStatusWithCommandResultInPendingWindowSwitchingMode=function(t){return t.isCommandResult&&this._isPendingSwitchingWindow()},Zu.prototype._isEmptyCommandInPendingWindowSwitchingMode=function(t){return!t&&this._isPendingSwitchingWindow()},Zu.prototype._observeFileDownloadingInNewWindow=function(){var e=this,t=new hs({isObservingFileDownloadingInNewWindow:!0});this._isPendingSwitchingWindow()&&this._sendStatus(t).then(function(t){t?e._onCommand(t):e._observeFileDownloadingInNewWindow()})},Zu.prototype._onReady=function(t){var e=this;this.debug&&(t.debug=this.debug,this.debug=null),this._isStatusWithCommandResultInPendingWindowSwitchingMode(t)&&this.emit(Yu),this._sendStatus(t).then(function(t){if(t)e._onCommand(t);else{if(e._isEmptyCommandInPendingWindowSwitchingMode(t))return void e.emit(Ku);e._onReady(new hs)}})},Zu.prototype._executeCommand=function(t){this.contextStorage.setItem(this.WINDOW_COMMAND_API_CALL_FLAG,!1),this.customCommandHandlers[t.type]?this._onCustomCommand(t):t.type===d.testDone?this._onTestDone(new hs({isCommandResult:!0})):t.type===d.setBreakpoint?this._onSetBreakpointCommand(t):t.type===d.disableDebug?this._onDisableDebugCommand():t.type===d.switchToMainWindow?this._onSwitchToMainWindowCommand(t):t.type===d.switchToIframe?this._onSwitchToIframeCommand(t):t.type===d.openWindow?this._onWindowOpenCommand(t):t.type===d.closeWindow?this._onWindowCloseCommand(t):t.type===d.getCurrentWindow?this._onGetCurrentWindowCommand(t):t.type===d.getCurrentWindows?this._onGetWindowsCommand():t.type===d.switchToWindow?this._onSwitchToWindow(t):t.type===d.switchToPreviousWindow?this._onSwitchToPreviousWindow(t):t.type===d.switchToParentWindow?this._onSwitchToParentWindow():m(t)?this._onBrowserManipulationCommand(t):t.type===d.executeClientFunction?this._onExecuteClientFunctionCommand(t):t.type===d.executeSelector?this._onExecuteSelectorCommand(t):t.type===d.navigateTo?this._onNavigateToCommand(t):t.type===d.setNativeDialogHandler?this._onSetNativeDialogHandlerCommand(t):t.type===d.getNativeDialogHistory?this._onGetNativeDialogHistoryCommand(t):t.type===d.getBrowserConsoleMessages?this._onGetBrowserConsoleMessagesCommand(t):t.type===d.setTestSpeed?this._onSetTestSpeedCommand(t):t.type===d.showAssertionRetriesStatus?this._onShowAssertionRetriesStatusCommand(t):t.type===d.hideAssertionRetriesStatus?this._onHideAssertionRetriesStatusCommand(t):t.type===d.backupStorages?this._onBackupStoragesCommand():t.type===d.closeChildWindowOnFileDownloading?this._closeChildWindowOnFileDownloading():t.type===d.prepareClientEnvironmentInDebugMode?this._onPrepareClientEnvironmentInDebugMode(t):t.type===d.getProxyUrl?this._onGetProxyUrlCommand(t):t.type===d.skipJsErrors?this._onSkipJsErrorsCommand(t):this._onActionCommand(t)},Zu.prototype._closeChildWindowOnFileDownloading=function(){this.activeChildWindowDriverLink.closeFileDownloadingWindow(),_.arrayUtils.remove(this.childWindowDriverLinks,this.activeChildWindowDriverLink),E.cursor.show(),this._startInternal()},Zu.prototype._isExecutableInTopWindowOnly=function(t){if((e=t).type===d.testDone||e.type===d.switchToMainWindow||e.type===d.setNativeDialogHandler||e.type===d.getNativeDialogHistory||e.type===d.setTestSpeed||e.type===d.showAssertionRetriesStatus||e.type===d.hideAssertionRetriesStatus||e.type===d.setBreakpoint||m(e)&&e.type!==d.takeElementScreenshot)return!0;var e,n=this.customCommandHandlers[t.type];return t.forceExecutionInTopWindowOnly||n&&n.isExecutableInTopWindowOnly},Zu.prototype._onCommand=function(n){var r=this;this.readyPromise.then(function(){var t,e=h(n);r.contextStorage.getItem(Lu)&&e?r._onReady(new hs({isCommandResult:!0})):(t=r.activeChildIframeDriverLink||r.contextStorage.getItem(Uu),r._isExecutableInTopWindowOnly(n)||!t?r._executeCommand(n):r._runInActiveIframe(n))})},Zu.prototype.setCustomCommandHandlers=function(t,e,n){this.customCommandHandlers[t]={isExecutableInTopWindowOnly:n,handler:e}},Zu.prototype._startInternal=function(t){this.role=cu,_.browser.startHeartbeat(this.communicationUrls.heartbeat,l.createNativeXHR),this._setupAssertionRetryIndication(),this._startCommandsProcessing(t)},Zu.prototype._stopInternal=function(){this.role=du,_.browser.stopHeartbeat(),E.cursor.hide()},Zu.prototype._setupAssertionRetryIndication=function(){var n=this;this.readyPromise.then(function(){n.statusBar.hidePageLoadingStatus();var t,e=n.contextStorage.getItem(Bu);e&&(t=n.contextStorage.getItem(Gu),0<e-(new Ru-t)&&n.statusBar.showWaitingAssertionRetriesStatus(e,t))})},Zu.prototype._startCommandsProcessing=function(t){void 0===t&&(t={finalizePendingCommand:!1,isFirstRequestAfterWindowSwitching:!1,result:void 0});var e,n,r=this.contextStorage.getItem(Mu);r&&(r.resent=!0),this.contextStorage.getItem(Pu)?r?this._onTestDone(r):this._checkStatus():this._failIfClientCodeExecutionIsInterrupted()||(e=t.finalizePendingCommand||this._hasPendingActionFlags(this.contextStorage),n=r||new hs({isCommandResult:e,isFirstRequestAfterWindowSwitching:t.isFirstRequestAfterWindowSwitching,result:t.result}),this.contextStorage.setItem(this.COMMAND_EXECUTING_FLAG,!1),this.contextStorage.setItem(this.EXECUTING_IN_IFRAME_FLAG,!1),this.contextStorage.setItem(this.PENDING_WINDOW_SWITCHING_FLAG,!1),this._onReady(n))},Zu.prototype._initParentWindowLink=function(){vc.opener&&vc.opener!==vc&&this.windowId&&(this.parentWindowDriverLink=new lu(vc))},Zu.prototype._initConsoleMessages=function(){var t=this.consoleMessages;t.ensureMessageContainer(this.windowId),this.consoleMessages=t},Zu.prototype._getDriverRole=function(){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return this.windowId?[4,_.browser.getActiveWindowId(this.communicationUrls.activeWindowId,l.createNativeXHR)]:[2,cu];case 1:return[2,t.sent().activeWindowId===this.windowId?cu:du]}})})},Zu.prototype._init=function(){var t=this.options,e=t.proxyless,n=t.dialogHandler,r=t.speed;this.contextStorage=new Qo(vc,{testRunId:this.testRunId,windowId:this.windowId,proxyless:e}),this.nativeDialogsTracker=new Ei(this.contextStorage,{proxyless:e,dialogHandler:n}),this.statusBar=new o.StatusBar(this.runInfo.userAgent,this.runInfo.fixtureName,this.runInfo.testName,this.contextStorage);var i=this;this.statusBar.on(this.statusBar.UNLOCK_PAGE_BTN_CLICK,function(){i.options.proxyless||_.disableRealEventsPreventing()}),this.speed=r,this._initConsoleMessages(),this._initParentWindowLink(),this._isOpenedInIframe()&&fs(new Po(this.windowId),vc.opener.top,ms,fr)},Zu.prototype._doFirstPageLoadSetup=function(){return s(this,void 0,void 0,function(){return C(this,function(t){return this.isFirstPageLoad&&this.options.canUseDefaultWindowActions,[2]})})},Zu.prototype.start=function(){return s(this,void 0,void 0,function(){var e;return C(this,function(t){switch(t.label){case 0:return this._init(),[4,this._doFirstPageLoadSetup()];case 1:return t.sent(),[4,this._restoreChildWindowLinks()];case 2:return t.sent(),[4,this._getDriverRole()];case 3:return e=t.sent(),this.role===cu||e===cu&&this._startInternal(),[2]}})})},Zu);function Zu(t,e,n,r){var i=Iu.call(this)||this;i.COMMAND_EXECUTING_FLAG="testcafe|driver|command-executing-flag",i.EXECUTING_IN_IFRAME_FLAG="testcafe|driver|executing-in-iframe-flag",i.PENDING_WINDOW_SWITCHING_FLAG="testcafe|driver|pending-window-switching-flag",i.WINDOW_COMMAND_API_CALL_FLAG="testcafe|driver|window-command-api-flag",i.testRunId=t,i.communicationUrls=e,i.runInfo=n,i.options=r,i.isFirstPageLoad=Su.get().isFirstPageLoad,i.customCommandHandlers={},i.contextStorage=null,i.nativeDialogsTracker=null,i.childIframeDriverLinks=[],i.activeChildIframeDriverLink=null,i.childWindowDriverLinks=[],i.parentWindowDriverLink=null,i.statusBar=null,i.windowId=i._getCurrentWindowId(),i.role=du,i.setAsMasterInProgress=!1,i.checkClosedChildWindowIntervalId=null;var o=new _.ClientRequestEmitter;return i.pageInitialRequestBarrier=new _.RequestBarrier(o),i.readyPromise=i._getReadyPromise(),i._initChildDriverListening(),_.pageUnloadBarrier.init(),i.options.proxyless||_.preventRealEvents(),l.on(l.EVENTS.consoleMethCalled,function(t){return i._onConsoleMessage(t)}),l.on(l.EVENTS.beforeFormSubmit,function(t){return i._onFormSubmit(t)}),l.on(l.EVENTS.windowOpened,function(t){return i._onChildWindowOpened(t)}),i.options.proxyless||(l.on(l.EVENTS.uncaughtJsError,function(t){return i._onJsError(t)}),l.on(l.EVENTS.unhandledRejection,function(t){return i._onJsError(t)})),i.setCustomCommandHandlers(d.unlockPage,function(){return i._unlockPageAfterTestIsDone()}),i.setCustomCommandHandlers(d.getActiveElement,function(){return i._getActiveElement()}),Nu.addInternalEventBeforeListener(vc,["beforeunload"],function(){i._sendStartToRestoreCommand()}),i.replicator=$r([new Fs]),i}var tc=(ec.prototype.establishConnection=function(){return fs(new qi,this.driverWindow,5e3,qn).then(function(t){return t.result})},ec.prototype.sendConfirmationMessage=function(t){gs({requestMsgId:t,window:this.driverWindow})},ec.prototype.onCommandExecuted=function(t){var e=new lo(t);c.eventSandbox.message.sendServiceMsg(e,this.driverWindow)},ec.prototype.hasPendingActionFlags=function(){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return[4,fs(new Go,this.driverWindow,5e3,qn)];case 1:return[2,t.sent().result]}})})},ec);function ec(t){this.driverWindow=t}var nc,rc=l.eventSandbox.message,ic=(t(oc,nc=Ei),oc.prototype._defaultDialogHandler=function(t){rc.sendServiceMsg({type:hi,dialogType:t,url:Ei._getPageUrl()},vc.top)},oc.prototype._addAppearedDialogs=function(t,e){rc.sendServiceMsg({type:di,dialogType:t,text:e,url:Ei._getPageUrl()},vc.top)},oc.prototype._onHandlerError=function(t,e){rc.sendServiceMsg({type:pi,dialogType:t,message:e,url:Ei._getPageUrl()},vc.top)},oc);function oc(t){return nc.call(this,null,t)||this}var sc,ac=c.eventSandbox.message,lc=(t(uc,sc=Qu),uc.prototype._onJsError=function(){},uc.prototype._onConsoleMessage=function(){},uc.prototype._onChildWindowOpened=function(){ac.sendServiceMsg(new ko,vc.top)},uc.prototype._stopInternal=function(){ac.sendServiceMsg(new Uo,vc.top)},uc.prototype._initParentDriverListening=function(){var n=this;c.eventSandbox.message.on(c.eventSandbox.message.SERVICE_MSG_RECEIVED_EVENT,function(t){var e=t.message;_.pageUnloadBarrier.wait(0).then(function(){if(e.type===Pi){if(n.lastParentDriverMessageId===e.id)return;n.lastParentDriverMessageId=e.id,n.readyPromise.then(function(){n.speed=e.testSpeed,n.parentDriverLink.sendConfirmationMessage(e.id),n._onCommand(e.command)})}e.type===Fi&&(n.nativeDialogsTracker.setHandler(e.dialogHandler),n._setNativeDialogHandlerInIframes(e.dialogHandler))})})},uc.prototype._onSwitchToMainWindowCommand=function(t){this._switchToMainWindow(t)},uc.prototype._onReady=function(t){this.parentDriverLink.onCommandExecuted(t)},uc.prototype._isInCommandExecution=function(){return s(this,void 0,void 0,function(){return C(this,function(t){switch(t.label){case 0:return c.utils.dom.isCrossDomainWindows(vc,vc.parent)?[4,this.parentDriverLink.hasPendingActionFlags()]:[3,2];case 1:return[2,t.sent()];case 2:return[2,this._hasPendingActionFlags(this.contextStorage)]}})})},uc.prototype._init=function(){return s(this,void 0,void 0,function(){var e,n,r;return C(this,function(t){switch(t.label){case 0:return[4,this.parentDriverLink.establishConnection()];case 1:return e=t.sent(),n=e.id,r=e.dispatchProxylessEventUrl,this.contextStorage=new Qo(vc,{testRunId:n,windowId:this.windowId,proxyless:this.options.proxyless}),this.communicationUrls.dispatchProxylessEvent=r,this._failIfClientCodeExecutionIsInterrupted()?[2]:[4,this._isInCommandExecution()];case 2:return t.sent()&&(this.contextStorage.setItem(this.COMMAND_EXECUTING_FLAG,!1),this.contextStorage.setItem(this.EXECUTING_IN_IFRAME_FLAG,!1),this._onReady(new hs({isCommandResult:!0}))),[2]}})})},uc.prototype.start=function(){this.nativeDialogsTracker=new ic({dialogHandler:this.options.dialogHandler,proxyless:this.options.proxyless}),this.statusBar=new o.IframeStatusBar;var t=this._init();this.readyPromise=c.Promise.all([this.readyPromise,t])},uc);function uc(t,e){var n=sc.call(this,t,{},{},e)||this;return n.lastParentDriverMessageId=null,n.parentDriverLink=new tc(vc.parent),n._initParentDriverListening(),n}var cc={NodeSnapshot:Ws,ElementSnapshot:Ps,SelectorExecutor:_a},dc="%testCafeDriver%",hc="%testCafeIframeDriver%",pc="%testCafeEmbeddingUtils%",fc=l.nativeMethods,mc=l.EVENTS.evalIframeScript;fc.objectDefineProperty(vc,dc,{configurable:!0,value:Qu}),fc.objectDefineProperty(vc,hc,{configurable:!0,value:lc}),fc.objectDefineProperty(vc,pc,{configurable:!0,value:cc}),l.on(mc,function(t){return gc(fc.contentWindowGetter.call(t.iframe))})}(vc["%hammerhead%"],vc["%hammerhead%"].Promise,vc["%testCafeCore%"],vc["%testCafeAutomation%"],vc["%testCafeUI%"])}(window);